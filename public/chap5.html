<!DOCTYPE html>
<html lang="en">
<head>
    <!-- IMPORTANT: Make sure your text editor saves this file with UTF-8 Encoding! -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logical Reasoning and Fallacies Quiz</title> <!-- Changed Title -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"], input[type="email"], input[type="tel"], input[type="password"] { width: 100%; padding: 8px; box-sizing: border-box; }
        input[type="radio"] { margin-right: 5px; }
        button { padding: 10px 20px; background-color: #007bff; color: white; border: none; cursor: pointer; margin-right: 10px; border-radius: 5px; }
        button:hover { background-color: #0056b3; }
        .hidden { display: none; }
        #error-message, #password-error, #login-error { color: red; font-size: 1.2em; text-align: center; }
        #success-message { color: green; font-size: 1.2em; text-align: center; }
        #results, #review-section, #submission-copy { margin-top: 20px; text-align: left; border: 1px solid #ccc; padding: 15px; border-radius: 5px; background-color: #f9f9f9;}
        #password-section, #login-section { text-align: center; max-width: 400px; margin: 20px auto; padding: 20px; border: 1px solid #ccc; border-radius: 5px; background-color: #f9f9f9;}
        #password-section input[type="password"], #login-section input[type="text"], #login-section input[type="password"] { width: calc(100% - 18px); }
        .question-result { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee; }
        #download-pdf, #download-response { margin-top: 10px; }
        #score { font-weight: bold; text-align: center; color: green; font-size: 1.4em; margin-top: 20px; }
        #review-section h2, #submission-copy h2, #results h1 { margin-bottom: 15px; text-align: center; color: #007bff;}
        #review-section button, #submission-copy button, #password-section button, #login-section button, #results button { margin-top: 15px; }
        .choices p { margin: 2px 0 2px 20px; }
    </style>
</head>
<body>
    <div id="login-section">
        <h1>Login to Access Quiz</h1>
        <div class="form-group">
            <label for="username">Username:</label>
            <input type="text" id="username" placeholder="Enter username" required>
        </div>
        <div class="form-group">
            <label for="login-password">Password:</label>
            <input type="password" id="login-password" placeholder="Enter password" required>
        </div>
        <button onclick="checkLogin()">Login</button>
        <p id="login-error" class="hidden">Incorrect username or password. Please try again.</p>
    </div>

    <div id="quiz-form" class="hidden">
        <h1>Logical Reasoning and Fallacies Quiz - Chapter 5</h1> <!-- Changed Title -->
        <form id="mcie-quiz"> <!-- ID Kept, content changed -->
            <!-- Student Information -->
            <div class="form-group">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="id_number">ID Number:</label>
                <input type="text" id="id_number" name="id_number" required>
            </div>
            <div class="form-group">
                <label for="section">Section:</label>
                <input type="text" id="section" name="section" required>
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required>
            </div>
            <div class="form-group">
                <label for="phone">Phone Number:</label>
                <input type="tel" id="phone" name="phone" required>
            </div>

            <!-- Logical Reasoning and Fallacies Multiple-Choice Questions -->
            <div class="form-group">
                <label>1. A fallacy is defined as:</label>
                <input type="radio" name="q1" value="A" required> A) An argument with only false premises.<br>
                <input type="radio" name="q1" value="B"> B) A defect in an argument consisting of something other than merely false premises.<br>
                <input type="radio" name="q1" value="C"> C) Any argument that fails to persuade the audience.<br>
                <input type="radio" name="q1" value="D"> D) A valid argument with a false conclusion.
            </div>
            <div class="form-group">
                <label>2. Fallacies often involve mistakes in reasoning or:</label>
                <input type="radio" name="q2" value="A" required> A) The use of overly complex language.<br>
                <input type="radio" name="q2" value="B"> B) The creation of an illusion that makes a bad argument appear good.<br>
                <input type="radio" name="q2" value="C"> C) Having too many premises.<br>
                <input type="radio" name="q2" value="D"> D) A conclusion that is obviously true.
            </div>
            <div class="form-group">
                <label>3. A "formal fallacy" is a defect related to the argument's:</label>
                <input type="radio" name="q3" value="A" required> A) Content and subject matter.<br>
                <input type="radio" name="q3" value="B"> B) Emotional appeal.<br>
                <input type="radio" name="q3" value="C"> C) Structure or form.<br>
                <input type="radio" name="q3" value="D"> D) Number of premises.
            </div>
            <div class="form-group">
                <label>4. An "informal fallacy" is a defect identified primarily through analyzing the argument's:</label>
                <input type="radio" name="q4" value="A" required> A) Structure or form.<br>
                <input type="radio" name="q4" value="B"> B) Content and meaning.<br>
                <input type="radio" name="q4" value="C"> C) Grammatical correctness.<br>
                <input type="radio" name="q4" value="D"> D) Length.
            </div>
            <div class="form-group">
                <label>5. Formal fallacies are found only in which type of argument?</label>
                <input type="radio" name="q5" value="A" required> A) Inductive arguments.<br>
                <input type="radio" name="q5" value="B"> B) Arguments from analogy.<br>
                <input type="radio" name="q5" value="C"> C) Deductive arguments with identifiable forms.<br>
                <input type="radio" name="q5" value="D"> D) Arguments based on statistics.
            </div>
            <div class="form-group">
                <label>6. The fallacy exemplified by the form "If A, then B. B. Therefore, A" is known as:</label>
                <input type="radio" name="q6" value="A" required> A) Denying the antecedent.<br>
                <input type="radio" name="q6" value="B"> B) Affirming the consequent.<br>
                <input type="radio" name="q6" value="C"> C) Modus ponens.<br>
                <input type="radio" name="q6" value="D"> D) Modus tollens.
            </div>
            <div class="form-group">
                <label>7. Informal fallacies like the "plants" example (All factories are plants...) often arise from issues like:</label>
                <input type="radio" name="q7" value="A" required> A) Invalid deductive structure.<br>
                <input type="radio" name="q7" value="B"> B) Ambiguity in the meaning of terms.<br>
                <input type="radio" name="q7" value="C"> C) Having too few premises.<br>
                <input type="radio" name="q7" value="D"> D) False premises only.
            </div>
            <div class="form-group">
                <label>8. Fallacies of Relevance share the common characteristic that their premises are:</label>
                <input type="radio" name="q8" value="A" required> A) Logically relevant but factually false.<br>
                <input type="radio" name="q8" value="B"> B) Too complex to understand.<br>
                <input type="radio" name="q8" value="C"> C) Logically irrelevant to the conclusion (though perhaps psychologically relevant).<br>
                <input type="radio" name="q8" value="D"> D) Sufficient but unacceptable.
            </div>
            <div class="form-group">
                <label>9. The Appeal to Force (Argumentum ad Baculum) fallacy occurs when an arguer:</label>
                <input type="radio" name="q9" value="A" required> A) Uses logically sound reasoning.<br>
                <input type="radio" name="q9" value="B"> B) Cites an unqualified authority.<br>
                <input type="radio" name="q9" value="C"> C) Poses a threat (physical or psychological) to persuade acceptance of a conclusion.<br>
                <input type="radio" name="q9" value="D"> D) Evokes pity from the listener.
            </div>
            <div class="form-group">
                <label>10. The Appeal to Pity (Argumentum ad Misericordiam) fallacy involves:</label>
                <input type="radio" name="q10" value="A" required> A) Attacking the opponent's character.<br>
                <input type="radio" name="q10" value="B"> B) Attempting to support a conclusion merely by evoking pity.<br>
                <input type="radio" name="q10" value="C"> C) Applying a general rule to a case it wasn't meant to cover.<br>
                <input type="radio" name="q10" value="D"> D) Using ambiguous language.
            </div>
            <div class="form-group">
                <label>11. The Appeal to People (Argumentum ad Populum) fallacy attempts persuasion by appealing to:</label>
                <input type="radio" name="q11" value="A" required> A) Logical evidence.<br>
                <input type="radio" name="q11" value="B"> B) The testimony of qualified experts.<br>
                <input type="radio" name="q11" value="C"> C) The desire for acceptance, esteem, or belonging within a group.<br>
                <input type="radio" name="q11" value="D"> D) A small, unrepresentative sample.
            </div>
            <div class="form-group">
                <label>12. The "direct approach" of Appeal to People involves:</label>
                <input type="radio" name="q12" value="A" required> A) Focusing on an individual's relationship to the crowd.<br>
                <input type="radio" name="q12" value="B"> B) Citing specific authorities.<br>
                <input type="radio" name="q12" value="C"> C) Exciting the emotions of a large crowd to win acceptance (mob mentality).<br>
                <input type="radio" name="q12" value="D"> D) Using complex statistical data.
            </div>
            <div class="form-group">
                <label>13. The "Bandwagon" form of indirect Appeal to People argues that:</label>
                <input type="radio" name="q13" value="A" required> A) A product is good because an admired person uses it.<br>
                <input type="radio" name="q13" value="B"> B) A position is correct because the majority accepts it.<br>
                <input type="radio" name="q13" value="C"> C) An idea is superior because only a select few accept it.<br>
                <input type="radio" name="q13" value="D"> D) A conclusion follows from pity.
            </div>
            <div class="form-group">
                <label>14. The "Appeal to Vanity" associates a product or idea with:</label>
                <input type="radio" name="q14" value="A" required> A) The majority opinion.<br>
                <input type="radio" name="q14" value="B"> B) Logical necessity.<br>
                <input type="radio" name="q14" value="C"> C) Someone who is admired or pursued.<br>
                <input type="radio" name="q14" value="D"> D) Scientific evidence.
            </div>
            <div class="form-group">
                <label>15. The "Appeal to Snobbery" suggests an idea/product is desirable because:</label>
                <input type="radio" name="q15" value="A" required> A) It is accepted by most people.<br>
                <input type="radio" name="q15" value="B"> B) It makes one part of a select, superior group.<br>
                <input type="radio" name="q15" value="C"> C) It evokes feelings of pity.<br>
                <input type="radio" name="q15" value="D"> D) It involves a threat.
            </div>
            <div class="form-group">
                <label>16. The Argument Against the Person (Argumentum ad Hominem) fallacy occurs when:</label>
                <input type="radio" name="q16" value="A" required> A) An arguer appeals to the majority.<br>
                <input type="radio" name="q16" value="B"> B) An arguer attacks the character or circumstances of the opposing arguer instead of the argument itself.<br>
                <input type="radio" name="q16" value="C"> C) An arguer misrepresents the opponent's argument.<br>
                <input type="radio" name="q16" value="D"> D) An arguer applies a general rule inappropriately.
            </div>
            <div class="form-group">
                <label>17. The "Ad Hominem Abusive" fallacy involves:</label>
                <input type="radio" name="q17" value="A" required> A) Pointing out the opponent's circumstances.<br>
                <input type="radio" name="q17" value="B"> B) Claiming the opponent is hypocritical.<br>
                <input type="radio" name="q17" value="C"> C) Verbally abusing the opponent.<br>
                <input type="radio" name="q17" value="D"> D) Misrepresenting the opponent's argument.
            </div>
            <div class="form-group">
                <label>18. The "Ad Hominem Circumstantial" fallacy attempts to discredit an argument by:</label>
                <input type="radio" name="q18" value="A" required> A) Verbally abusing the opponent.<br>
                <input type="radio" name="q18" value="B"> B) Alluding to circumstances that allegedly affect the opponent, suggesting predisposition.<br>
                <input type="radio" name="q18" value="C"> C) Citing an unqualified authority.<br>
                <input type="radio" name="q18" value="D"> D) Pointing out that the opponent doesn't follow their own advice.
            </div>
            <div class="form-group">
                <label>19. The "Tu Quoque" (You Too) fallacy involves attempting to make the first arguer appear:</label>
                <input type="radio" name="q19" value="A" required> A) Unintelligent.<br>
                <input type="radio" name="q19" value="B"> B) Unqualified.<br>
                <input type="radio" name="q19" value="C"> C) Hypocritical or arguing in bad faith.<br>
                <input type="radio" name="q19" value="D"> D) Emotionally unstable.
            </div>
            <div class="form-group">
                <label>20. The fallacy of "Accident" is committed when:</label>
                <input type="radio" name="q20" value="A" required> A) A general rule is applied to a specific case it was not intended to cover.<br>
                <input type="radio" name="q20" value="B"> B) An arguer appeals to ignorance.<br>
                <input type="radio" name="q20" value="C"> C) A conclusion is drawn from an analogy that is not strong enough.<br>
                <input type="radio" name="q20" value="D"> D) An arguer distorts an opponent's argument.
            </div>
            <div class="form-group">
                <label>21. The "Straw Man" fallacy involves:</label>
                <input type="radio" name="q21" value="A" required> A) Attacking the person making the argument.<br>
                <input type="radio" name="q21" value="B"> B) Distorting an opponent's argument to make it easier to attack.<br>
                <input type="radio" name="q21" value="C"> C) Applying a general rule incorrectly.<br>
                <input type="radio" name="q21" value="D"> D) Appealing to pity.
            </div>
            <div class="form-group">
                <label>22. The "Missing the Point" (Ignoratio Elenchi) fallacy occurs when:</label>
                <input type="radio" name="q22" value="A" required> A) The premises support one particular conclusion, but a different, often related conclusion is drawn.<br>
                <input type="radio" name="q22" value="B"> B) An arguer changes the subject entirely.<br>
                <input type="radio" name="q22" value="C"> C) An arguer attacks a distorted version of the opponent's argument.<br>
                <input type="radio" name="q22" value="D"> D) A general rule is misapplied.
            </div>
            <div class="form-group">
                <label>23. The "Red Herring" fallacy involves:</label>
                <input type="radio" name="q23" value="A" required> A) Attacking the person rather than the argument.<br>
                <input type="radio" name="q23" value="B"> B) Drawing the wrong conclusion from the premises.<br>
                <input type="radio" name="q23" value="C"> C) Distorting the opponent's argument.<br>
                <input type="radio" name="q23" value="D"> D) Diverting the listener's attention by changing the subject to a different or subtly related one.
            </div>
            <div class="form-group">
                <label>24. How can Straw Man be distinguished from Red Herring?</label>
                <input type="radio" name="q24" value="A" required> A) Red Herring always involves two arguers, Straw Man does not.<br>
                <input type="radio" name="q24" value="B"> B) Straw Man involves distorting the original argument, while Red Herring involves changing the subject.<br>
                <input type="radio" name="q24" value="C"> C) Straw Man attacks the person, Red Herring attacks the argument.<br>
                <input type="radio" name="q24" value="D"> D) Red Herring uses threats, Straw Man uses pity.
            </div>
            <div class="form-group">
                <label>25. Fallacies of Weak Induction occur because the connection between premises and conclusion is:</label>
                <input type="radio" name="q25" value="A" required> A) Logically irrelevant.<br>
                <input type="radio" name="q25" value="B"> B) Based on ambiguity.<br>
                <input type="radio" name="q25" value="C"> C) Too weak to support the conclusion strongly.<br>
                <input type="radio" name="q25" value="D"> D) Based on unwarranted assumptions.
            </div>
            <div class="form-group">
                <label>26. The Appeal to Unqualified Authority (Ad Verecundiam) fallacy occurs when the cited authority:</label>
                <input type="radio" name="q26" value="A" required> A) Is a recognized expert in the relevant field.<br>
                <input type="radio" name="q26" value="B"> B) Might lack credibility (expertise, bias, motive to lie).<br>
                <input type="radio" name="q26" value="C"> C) Provides strong evidence.<br>
                <input type="radio" name="q26" value="D"> D) Agrees with the majority opinion.
            </div>
            <div class="form-group">
                <label>27. The Appeal to Ignorance (Ad Ignorantiam) fallacy states that a conclusion is true because:</label>
                <input type="radio" name="q27" value="A" required> A) There is positive evidence for it.<br>
                <input type="radio" name="q27" value="B"> B) An expert supports it.<br>
                <input type="radio" name="q27" value="C"> C) It has not been proven false (or false because it has not been proven true).<br>
                <input type="radio" name="q27" value="D"> D) Most people believe it.
            </div>
            <div class="form-group">
                <label>28. Hasty Generalization (Converse Accident) occurs when a conclusion about a whole group is drawn from:</label>
                <input type="radio" name="q28" value="A" required> A) A large, representative sample.<br>
                <input type="radio" name="q28" value="B"> B) A premise based on definition.<br>
                <input type="radio" name="q28" value="C"> C) A sample that is likely atypical (e.g., too small or not random).<br>
                <input type="radio" name="q28" value="D"> D) A chain reaction of causes.
            </div>
            <div class="form-group">
                <label>29. The False Cause fallacy occurs when the link between premises and conclusion depends on:</label>
                <input type="radio" name="q29" value="A" required> A) A strong statistical correlation.<br>
                <input type="radio" name="q29" value="B"> B) An imagined causal connection that probably doesn't exist.<br>
                <input type="radio" name="q29" value="C"> C) A valid deductive inference.<br>
                <input type="radio" name="q29" value="D"> D) An appeal to authority.
            </div>
            <div class="form-group">
                <label>30. The post hoc ergo propter hoc variety of False Cause assumes that because one event preceded another, the first event:</label>
                <input type="radio" name="q30" value="A" required> A) Was merely correlated with the second.<br>
                <input type="radio" name="q30" value="B"> B) Was caused by the second event.<br>
                <input type="radio" name="q30" value="C"> C) Caused the second event.<br>
                <input type="radio" name="q30" value="D"> D) Was irrelevant to the second event.
            </div>
            <div class="form-group">
                <label>31. The "oversimplified cause" fallacy occurs when:</label>
                <input type="radio" name="q31" value="A" required> A) No cause can be identified for an effect.<br>
                <input type="radio" name="q31" value="B"> B) A multitude of causes is responsible, but the arguer selects just one as the sole cause.<br>
                <input type="radio" name="q31" value="C"> C) An effect is mistaken for a cause.<br>
                <input type="radio" name="q31" value="D"> D) A conclusion is based on superstition.
            </div>
            <div class="form-group">
                <label>32. The Slippery Slope fallacy assumes:</label>
                <input type="radio" name="q32" value="A" required> A) A causal connection exists based only on temporal succession.<br>
                <input type="radio" name="q32" value="B"> B) A chain reaction of events will occur, usually with insufficient evidence for the connections.<br>
                <input type="radio" name="q32" value="C"> C) An analogy holds between two dissimilar things.<br>
                <input type="radio" name="q32" value="D"> D) A general rule applies universally without exception.
            </div>
            <div class="form-group">
                <label>33. The Weak Analogy fallacy is committed when:</label>
                <input type="radio" name="q33" value="A" required> A) An argument uses a comparison between two things.<br>
                <input type="radio" name="q33" value="B"> B) The analogy or similarity between the two things being compared is not strong enough to support the conclusion.<br>
                <input type="radio" name="q33" value="C"> C) An argument draws a conclusion about a group based on a sample.<br>
                <input type="radio" name="q33" value="D"> D) An arguer cites an expert outside their field.
            </div>
            <div class="form-group">
                <label>34. Fallacies of Presumption arise because the premises:</label>
                <input type="radio" name="q34" value="A" required> A) Are irrelevant to the conclusion.<br>
                <input type="radio" name="q34" value="B"> B) Provide insufficient support for the conclusion.<br>
                <input type="radio" name="q34" value="C"> C) Presume what they purport to prove.<br>
                <input type="radio" name="q34" value="D"> D) Contain ambiguous words.
            </div>
            <div class="form-group">
                <label>35. Begging the Question (Petitio Principii) involves:</label>
                <input type="radio" name="q35" value="A" required> A) Attacking the questioner rather than the question.<br>
                <input type="radio" name="q35" value="B"> B) Asking a question that presumes something unproven.<br>
                <input type="radio" name="q35" value="C"> C) Assuming the truth of the conclusion one is trying to prove (often by leaving out a key premise, restating the premise, or circular reasoning).<br>
                <input type="radio" name="q35" value="D"> D) Appealing to ignorance.
            </div>
            <div class="form-group">
                <label>36. Leaving out a possibly false key premise while creating the illusion it isn't needed is a form of:</label>
                <input type="radio" name="q36" value="A" required> A) Complex Question.<br>
                <input type="radio" name="q36" value="B"> B) False Dichotomy.<br>
                <input type="radio" name="q36" value="C"> C) Begging the Question.<br>
                <input type="radio" name="q36" value="D"> D) Suppressed Evidence.
            </div>
            <div class="form-group">
                <label>37. Reasoning in a circle (e.g., "A is true because B is true, and B is true because A is true") is a form of:</label>
                <input type="radio" name="q37" value="A" required> A) Hasty Generalization.<br>
                <input type="radio" name="q37" value="B"> B) Begging the Question.<br>
                <input type="radio" name="q37" value="C"> C) Appeal to Force.<br>
                <input type="radio" name="q37" value="D"> D) Equivocation.
            </div>
            <div class="form-group">
                <label>38. The Complex Question fallacy involves:</label>
                <input type="radio" name="q38" value="A" required> A) Asking a question that is too difficult to answer.<br>
                <input type="radio" name="q38" value="B"> B) Asking two or more questions in the guise of a single question.<br>
                <input type="radio" name="q38" value="C"> C) Begging the question in interrogative form.<br>
                <input type="radio" name="q38" value="D"> D) Asking a question that has no relevance.
            </div>
            <div class="form-group">
                <label>39. The False Dichotomy (or False Binary) fallacy is committed when:</label>
                <input type="radio" name="q39" value="A" required> A) An arguer presents two alternatives as if they were the only ones available, when others exist.<br>
                <input type="radio" name="q39" value="B"> B) A key piece of evidence is ignored.<br>
                <input type="radio" name="q39" value="C"> C) An argument uses circular reasoning.<br>
                <input type="radio" name="q39" value="D"> D) A question presumes an unproven condition.
            </div>
            <div class="form-group">
                <label>40. The Suppressed Evidence fallacy occurs when an arguer:</label>
                <input type="radio" name="q40" value="A" required> A) Presents irrelevant premises.<br>
                <input type="radio" name="q40" value="B"> B) Ignores important evidence that outweighs the presented evidence and entails a different conclusion.<br>
                <input type="radio" name="q40" value="C"> C) Uses ambiguous language.<br>
                <input type="radio" name="q40" value="D"> D) Commits a formal fallacy.
            </div>
            <div class="form-group">
                <label>41. Fallacies of Ambiguity arise from:</label>
                <input type="radio" name="q41" value="A" required> A) Irrelevant premises.<br>
                <input type="radio" name="q41" value="B"> B) Insufficient evidence.<br>
                <input type="radio" name="q41" value="C"> C) An ambiguity in the meaning of words or statements.<br>
                <input type="radio" name="q41" value="D"> D) Presuming the truth of the conclusion.
            </div>
            <div class="form-group">
                <label>42. The fallacy of Equivocation occurs when:</label>
                <input type="radio" name="q42" value="A" required> A) A statement's grammatical structure allows multiple interpretations.<br>
                <input type="radio" name="q42" value="B"> B) A word or phrase is used in two different senses within the same argument.<br>
                <input type="radio" name="q42" value="C"> C) An arguer misinterprets an opponent's ambiguous statement.<br>
                <input type="radio" name="q42" value="D"> D) An attribute is improperly transferred from whole to parts.
            </div>
            <div class="form-group">
                <label>43. The fallacy of Amphiboly occurs when:</label>
                <input type="radio" name="q43" value="A" required> A) A word has multiple meanings.<br>
                <input type="radio" name="q43" value="B"> B) An arguer draws a conclusion based on misinterpreting a grammatically ambiguous statement (often made by someone else).<br>
                <input type="radio" name="q43" value="C"> C) An attribute is improperly transferred from parts to whole.<br>
                <input type="radio" name="q43" value="D"> D) An arguer uses circular reasoning.
            </div>
            <div class="form-group">
                <label>44. Fallacies of Grammatical Analogy (Composition and Division) appear plausible because:</label>
                <input type="radio" name="q44" value="A" required> A) They rely on emotional appeals.<br>
                <input type="radio" name="q44" value="B"> B) They resemble arguments with correct grammatical structures.<br>
                <input type="radio" name="q44" value="C"> C) They always have true premises.<br>
                <input type="radio" name="q44" value="D"> D) They use precise language.
            </div>
            <div class="form-group">
                <label>45. The fallacy of Composition involves an erroneous transference of an attribute from:</label>
                <input type="radio" name="q45" value="A" required> A) Whole to parts.<br>
                <input type="radio" name="q45" value="B"> B) Parts to whole.<br>
                <input type="radio" name="q45" value="C"> C) One premise to another.<br>
                <input type="radio" name="q45" value="D"> D) Conclusion back to premises.
            </div>
            <div class="form-group">
                <label>46. Arguing that because each player on a team is excellent, the team as a whole must be excellent, likely commits the fallacy of:</label>
                <input type="radio" name="q46" value="A" required> A) Division.<br>
                <input type="radio" name="q46" value="B"> B) Hasty Generalization.<br>
                <input type="radio" name="q46" value="C"> C) Composition.<br>
                <input type="radio" name="q46" value="D"> D) Accident.
            </div>
            <div class="form-group">
                <label>47. The fallacy of Division involves an erroneous transference of an attribute from:</label>
                <input type="radio" name="q47" value="A" required> A) Parts to whole.<br>
                <input type="radio" name="q47" value="B"> B) Whole to parts.<br>
                <input type="radio" name="q47" value="C"> C) Premises to conclusion.<br>
                <input type="radio" name="q47" value="D"> D) One case to another via analogy.
            </div>
            <div class="form-group">
                <label>48. Arguing that because a machine is heavy, its component parts must be heavy, likely commits the fallacy of:</label>
                <input type="radio" name="q48" value="A" required> A) Composition.<br>
                <input type="radio" name="q48" value="B"> B) Accident.<br>
                <input type="radio" name="q48" value="C"> C) Hasty Generalization.<br>
                <input type="radio" name="q48" value="D"> D) Division.
            </div>
            <div class="form-group">
                <label>49. How can Composition be distinguished from Hasty Generalization?</label>
                <input type="radio" name="q49" value="A" required> A) Composition applies only to deductive arguments.<br>
                <input type="radio" name="q49" value="B"> B) Hasty Generalization moves from parts to whole, Composition from specific to general.<br>
                <input type="radio" name="q49" value="C"> C) Composition involves transferring an attribute from parts to the whole class (collective predication), while Hasty Generalization moves from an atypical sample to a general rule (distributive predication).<br>
                <input type="radio" name="q49" value="D"> D) Hasty Generalization uses ambiguity, Composition does not.
            </div>
            <div class="form-group">
                <label>50. How can Division be distinguished from Accident?</label>
                <input type="radio" name="q50" value="A" required> A) Division applies only to inductive arguments.<br>
                <input type="radio" name="q50" value="B"> B) Accident moves from whole to parts, Division from general to specific.<br>
                <input type="radio" name="q50" value="C"> C) Division involves transferring an attribute from a class/whole to its parts/members, while Accident misapplies a general rule to a specific case.<br>
                <input type="radio" name="q50" value="D"> D) Accident uses ambiguity, Division does not.
            </div>


            <button type="button" onclick="showReview()">Submit</button>
        </form>
        <div id="error-message" class="hidden">
            <p>Something went wrong. Please try again.</p>
        </div>
    </div>

    <div id="review-section" class="hidden">
        <h2>Review Your Answers</h2>
        <div id="review-content"></div>
        <button onclick="editForm()">Edit</button>
        <button onclick="downloadResponse()" id="download-response">Download My Response</button>
        <button onclick="confirmSubmission()">Confirm Submission</button>
    </div>

    <div id="submission-copy" class="hidden">
        <h2>Your Submitted Answers</h2>
        <div id="submission-content"></div>
        <button onclick="proceedToPassword()">Proceed</button>
    </div>

    <div id="password-section" class="hidden">
        <h1 id="success-message">Your response has been submitted</h1>
        <p>You can view your result (score) by entering the password.</p>
        <input type="password" id="password" placeholder="Enter password">
        <button onclick="checkPassword()">Submit</button>
        <p id="password-error" class="hidden">Incorrect password. Please try again.</p>
    </div>

    <div id="results" class="hidden">
        <h1>Quiz Results</h1>
        <p id="student-info"></p>
        <div id="answers"></div>
        <p id="score"></p>
        <button id="download-pdf" onclick="downloadPDF()">Download Results PDF</button>
    </div>

        <script>
        let quizData = null;
        let formData = null;
        const { jsPDF } = window.jspdf;
        const TOTAL_QUESTIONS = 50; // Total number of questions

        // *** ADD/UPDATE THIS LINE - SET CHAPTER TO 5 ***
        // Define the chapter number for THIS specific quiz file (Chapter 5)
        const CURRENT_QUIZ_CHAPTER = 5;

        // *** ADD/UPDATE THIS LINE - DEFINE COURSE CODE ***
        const COURSE_CODE = 'PHIL1009'; // Course code updated to PHIL1009 (or change if needed)

        // Valid login credentials (Remains the same)
        const validCredentials = [
            { username: 'section19', password: '123' },
            { username: 'section20', password: '123' },
            { username: 'muzemuza', password: 'moh' },
            { username: 'section21', password: '123' }
            // Add more valid credentials as needed
        ];

        // Structure holding question texts and choices (UPDATED FOR FALLACIES Ch5)
        const allQuestionsData = {
             q1: { text: 'A fallacy is defined as:', choices: { A: 'An argument with only false premises.', B: 'A defect in an argument consisting of something other than merely false premises.', C: 'Any argument that fails to persuade the audience.', D: 'A valid argument with a false conclusion.' } },
             q2: { text: 'Fallacies often involve mistakes in reasoning or:', choices: { A: 'The use of overly complex language.', B: 'The creation of an illusion that makes a bad argument appear good.', C: 'Having too many premises.', D: 'A conclusion that is obviously true.' } },
             q3: { text: 'A "formal fallacy" is a defect related to the argument\'s:', choices: { A: 'Content and subject matter.', B: 'Emotional appeal.', C: 'Structure or form.', D: 'Number of premises.' } },
             q4: { text: 'An "informal fallacy" is a defect identified primarily through analyzing the argument\'s:', choices: { A: 'Structure or form.', B: 'Content and meaning.', C: 'Grammatical correctness.', D: 'Length.' } },
             q5: { text: 'Formal fallacies are found only in which type of argument?', choices: { A: 'Inductive arguments.', B: 'Arguments from analogy.', C: 'Deductive arguments with identifiable forms.', D: 'Arguments based on statistics.' } },
             q6: { text: 'The fallacy exemplified by the form "If A, then B. B. Therefore, A" is known as:', choices: { A: 'Denying the antecedent.', B: 'Affirming the consequent.', C: 'Modus ponens.', D: 'Modus tollens.' } },
             q7: { text: 'Informal fallacies like the "plants" example (All factories are plants...) often arise from issues like:', choices: { A: 'Invalid deductive structure.', B: 'Ambiguity in the meaning of terms.', C: 'Having too few premises.', D: 'False premises only.' } },
             q8: { text: 'Fallacies of Relevance share the common characteristic that their premises are:', choices: { A: 'Logically relevant but factually false.', B: 'Too complex to understand.', C: 'Logically irrelevant to the conclusion (though perhaps psychologically relevant).', D: 'Sufficient but unacceptable.' } },
             q9: { text: 'The Appeal to Force (Argumentum ad Baculum) fallacy occurs when an arguer:', choices: { A: 'Uses logically sound reasoning.', B: 'Cites an unqualified authority.', C: 'Poses a threat (physical or psychological) to persuade acceptance of a conclusion.', D: 'Evokes pity from the listener.' } },
             q10: { text: 'The Appeal to Pity (Argumentum ad Misericordiam) fallacy involves:', choices: { A: 'Attacking the opponent\'s character.', B: 'Attempting to support a conclusion merely by evoking pity.', C: 'Applying a general rule to a case it wasn\'t meant to cover.', D: 'Using ambiguous language.' } },
             q11: { text: 'The Appeal to People (Argumentum ad Populum) fallacy attempts persuasion by appealing to:', choices: { A: 'Logical evidence.', B: 'The testimony of qualified experts.', C: 'The desire for acceptance, esteem, or belonging within a group.', D: 'A small, unrepresentative sample.' } },
             q12: { text: 'The "direct approach" of Appeal to People involves:', choices: { A: 'Focusing on an individual\'s relationship to the crowd.', B: 'Citing specific authorities.', C: 'Exciting the emotions of a large crowd to win acceptance (mob mentality).', D: 'Using complex statistical data.' } },
             q13: { text: 'The "Bandwagon" form of indirect Appeal to People argues that:', choices: { A: 'A product is good because an admired person uses it.', B: 'A position is correct because the majority accepts it.', C: 'An idea is superior because only a select few accept it.', D: 'A conclusion follows from pity.' } },
             q14: { text: 'The "Appeal to Vanity" associates a product or idea with:', choices: { A: 'The majority opinion.', B: 'Logical necessity.', C: 'Someone who is admired or pursued.', D: 'Scientific evidence.' } },
             q15: { text: 'The "Appeal to Snobbery" suggests an idea/product is desirable because:', choices: { A: 'It is accepted by most people.', B: 'It makes one part of a select, superior group.', C: 'It evokes feelings of pity.', D: 'It involves a threat.' } },
             q16: { text: 'The Argument Against the Person (Argumentum ad Hominem) fallacy occurs when:', choices: { A: 'An arguer appeals to the majority.', B: 'An arguer attacks the character or circumstances of the opposing arguer instead of the argument itself.', C: 'An arguer misrepresents the opponent\'s argument.', D: 'An arguer applies a general rule inappropriately.' } },
             q17: { text: 'The "Ad Hominem Abusive" fallacy involves:', choices: { A: 'Pointing out the opponent\'s circumstances.', B: 'Claiming the opponent is hypocritical.', C: 'Verbally abusing the opponent.', D: 'Misrepresenting the opponent\'s argument.' } },
             q18: { text: 'The "Ad Hominem Circumstantial" fallacy attempts to discredit an argument by:', choices: { A: 'Verbally abusing the opponent.', B: 'Alluding to circumstances that allegedly affect the opponent, suggesting predisposition.', C: 'Citing an unqualified authority.', D: 'Pointing out that the opponent doesn\'t follow their own advice.' } },
             q19: { text: 'The "Tu Quoque" (You Too) fallacy involves attempting to make the first arguer appear:', choices: { A: 'Unintelligent.', B: 'Unqualified.', C: 'Hypocritical or arguing in bad faith.', D: 'Emotionally unstable.' } },
             q20: { text: 'The fallacy of "Accident" is committed when:', choices: { A: 'A general rule is applied to a specific case it was not intended to cover.', B: 'An arguer appeals to ignorance.', C: 'A conclusion is drawn from an analogy that is not strong enough.', D: 'An arguer distorts an opponent\'s argument.' } },
             q21: { text: 'The "Straw Man" fallacy involves:', choices: { A: 'Attacking the person making the argument.', B: 'Distorting an opponent\'s argument to make it easier to attack.', C: 'Applying a general rule incorrectly.', D: 'Appealing to pity.' } },
             q22: { text: 'The "Missing the Point" (Ignoratio Elenchi) fallacy occurs when:', choices: { A: 'The premises support one particular conclusion, but a different, often related conclusion is drawn.', B: 'An arguer changes the subject entirely.', C: 'An arguer attacks a distorted version of the opponent\'s argument.', D: 'A general rule is misapplied.' } },
             q23: { text: 'The "Red Herring" fallacy involves:', choices: { A: 'Attacking the person rather than the argument.', B: 'Drawing the wrong conclusion from the premises.', C: 'Distorting the opponent\'s argument.', D: 'Diverting the listener\'s attention by changing the subject to a different or subtly related one.' } },
             q24: { text: 'How can Straw Man be distinguished from Red Herring?', choices: { A: 'Red Herring always involves two arguers, Straw Man does not.', B: 'Straw Man involves distorting the original argument, while Red Herring involves changing the subject.', C: 'Straw Man attacks the person, Red Herring attacks the argument.', D: 'Red Herring uses threats, Straw Man uses pity.' } },
             q25: { text: 'Fallacies of Weak Induction occur because the connection between premises and conclusion is:', choices: { A: 'Logically irrelevant.', B: 'Based on ambiguity.', C: 'Too weak to support the conclusion strongly.', D: 'Based on unwarranted assumptions.' } },
             q26: { text: 'The Appeal to Unqualified Authority (Ad Verecundiam) fallacy occurs when the cited authority:', choices: { A: 'Is a recognized expert in the relevant field.', B: 'Might lack credibility (expertise, bias, motive to lie).', C: 'Provides strong evidence.', D: 'Agrees with the majority opinion.' } },
             q27: { text: 'The Appeal to Ignorance (Ad Ignorantiam) fallacy states that a conclusion is true because:', choices: { A: 'There is positive evidence for it.', B: 'An expert supports it.', C: 'It has not been proven false (or false because it has not been proven true).', D: 'Most people believe it.' } },
             q28: { text: 'Hasty Generalization (Converse Accident) occurs when a conclusion about a whole group is drawn from:', choices: { A: 'A large, representative sample.', B: 'A premise based on definition.', C: 'A sample that is likely atypical (e.g., too small or not random).', D: 'A chain reaction of causes.' } },
             q29: { text: 'The False Cause fallacy occurs when the link between premises and conclusion depends on:', choices: { A: 'A strong statistical correlation.', B: 'An imagined causal connection that probably doesn\'t exist.', C: 'A valid deductive inference.', D: 'An appeal to authority.' } },
             q30: { text: 'The post hoc ergo propter hoc variety of False Cause assumes that because one event preceded another, the first event:', choices: { A: 'Was merely correlated with the second.', B: 'Was caused by the second event.', C: 'Caused the second event.', D: 'Was irrelevant to the second event.' } },
             q31: { text: 'The "oversimplified cause" fallacy occurs when:', choices: { A: 'No cause can be identified for an effect.', B: 'A multitude of causes is responsible, but the arguer selects just one as the sole cause.', C: 'An effect is mistaken for a cause.', D: 'A conclusion is based on superstition.' } },
             q32: { text: 'The Slippery Slope fallacy assumes:', choices: { A: 'A causal connection exists based only on temporal succession.', B: 'A chain reaction of events will occur, usually with insufficient evidence for the connections.', C: 'An analogy holds between two dissimilar things.', D: 'A general rule applies universally without exception.' } },
             q33: { text: 'The Weak Analogy fallacy is committed when:', choices: { A: 'An argument uses a comparison between two things.', B: 'The analogy or similarity between the two things being compared is not strong enough to support the conclusion.', C: 'An argument draws a conclusion about a group based on a sample.', D: 'An arguer cites an expert outside their field.' } },
             q34: { text: 'Fallacies of Presumption arise because the premises:', choices: { A: 'Are irrelevant to the conclusion.', B: 'Provide insufficient support for the conclusion.', C: 'Presume what they purport to prove.', D: 'Contain ambiguous words.' } },
             q35: { text: 'Begging the Question (Petitio Principii) involves:', choices: { A: 'Attacking the questioner rather than the question.', B: 'Asking a question that presumes something unproven.', C: 'Assuming the truth of the conclusion one is trying to prove (often by leaving out a key premise, restating the premise, or circular reasoning).', D: 'Appealing to ignorance.' } },
             q36: { text: 'Leaving out a possibly false key premise while creating the illusion it isn\'t needed is a form of:', choices: { A: 'Complex Question.', B: 'False Dichotomy.', C: 'Begging the Question.', D: 'Suppressed Evidence.' } },
             q37: { text: 'Reasoning in a circle (e.g., "A is true because B is true, and B is true because A is true") is a form of:', choices: { A: 'Hasty Generalization.', B: 'Begging the Question.', C: 'Appeal to Force.', D: 'Equivocation.' } },
             q38: { text: 'The Complex Question fallacy involves:', choices: { A: 'Asking a question that is too difficult to answer.', B: 'Asking two or more questions in the guise of a single question.', C: 'Begging the question in interrogative form.', D: 'Asking a question that has no relevance.' } },
             q39: { text: 'The False Dichotomy (or False Binary) fallacy is committed when:', choices: { A: 'An arguer presents two alternatives as if they were the only ones available, when others exist.', B: 'A key piece of evidence is ignored.', C: 'An argument uses circular reasoning.', D: 'A question presumes an unproven condition.' } },
             q40: { text: 'The Suppressed Evidence fallacy occurs when an arguer:', choices: { A: 'Presents irrelevant premises.', B: 'Ignores important evidence that outweighs the presented evidence and entails a different conclusion.', C: 'Uses ambiguous language.', D: 'Commits a formal fallacy.' } },
             q41: { text: 'Fallacies of Ambiguity arise from:', choices: { A: 'Irrelevant premises.', B: 'Insufficient evidence.', C: 'An ambiguity in the meaning of words or statements.', D: 'Presuming the truth of the conclusion.' } },
             q42: { text: 'The fallacy of Equivocation occurs when:', choices: { A: 'A statement\'s grammatical structure allows multiple interpretations.', B: 'A word or phrase is used in two different senses within the same argument.', C: 'An arguer misinterprets an opponent\'s ambiguous statement.', D: 'An attribute is improperly transferred from whole to parts.' } },
             q43: { text: 'The fallacy of Amphiboly occurs when:', choices: { A: 'A word has multiple meanings.', B: 'An arguer draws a conclusion based on misinterpreting a grammatically ambiguous statement (often made by someone else).', C: 'An attribute is improperly transferred from parts to whole.', D: 'An arguer uses circular reasoning.' } },
             q44: { text: 'Fallacies of Grammatical Analogy (Composition and Division) appear plausible because:', choices: { A: 'They rely on emotional appeals.', B: 'They resemble arguments with correct grammatical structures.', C: 'They always have true premises.', D: 'They use precise language.' } },
             q45: { text: 'The fallacy of Composition involves an erroneous transference of an attribute from:', choices: { A: 'Whole to parts.', B: 'Parts to whole.', C: 'One premise to another.', D: 'Conclusion back to premises.' } },
             q46: { text: 'Arguing that because each player on a team is excellent, the team as a whole must be excellent, likely commits the fallacy of:', choices: { A: 'Division.', B: 'Hasty Generalization.', C: 'Composition.', D: 'Accident.' } },
             q47: { text: 'The fallacy of Division involves an erroneous transference of an attribute from:', choices: { A: 'Parts to whole.', B: 'Whole to parts.', C: 'Premises to conclusion.', D: 'One case to another via analogy.' } },
             q48: { text: 'Arguing that because a machine is heavy, its component parts must be heavy, likely commits the fallacy of:', choices: { A: 'Composition.', B: 'Accident.', C: 'Hasty Generalization.', D: 'Division.' } },
             q49: { text: 'How can Composition be distinguished from Hasty Generalization?', choices: { A: 'Composition applies only to deductive arguments.', B: 'Hasty Generalization moves from parts to whole, Composition from specific to general.', C: 'Composition involves transferring an attribute from parts to the whole class (collective predication), while Hasty Generalization moves from an atypical sample to a general rule (distributive predication).', D: 'Hasty Generalization uses ambiguity, Composition does not.' } },
             q50: { text: 'How can Division be distinguished from Accident?', choices: { A: 'Division applies only to inductive arguments.', B: 'Accident moves from whole to parts, Division from general to specific.', C: 'Division involves transferring an attribute from a class/whole to its parts/members, while Accident misapplies a general rule to a specific case.', D: 'Accident uses ambiguity, Division does not.' } }
        };

        // Correct answers mapped to letters (UPDATED FOR FALLACIES Ch5)
        const correctAnswersMap = {
             q1: 'B', q2: 'B', q3: 'C', q4: 'B', q5: 'C',
             q6: 'B', q7: 'B', q8: 'C', q9: 'C', q10: 'B',
             q11: 'C', q12: 'C', q13: 'B', q14: 'C', q15: 'B',
             q16: 'B', q17: 'C', q18: 'B', q19: 'C', q20: 'A',
             q21: 'B', q22: 'A', q23: 'D', q24: 'B', q25: 'C',
             q26: 'B', q27: 'C', q28: 'C', q29: 'B', q30: 'C',
             q31: 'B', q32: 'B', q33: 'B', q34: 'C', q35: 'C',
             q36: 'C', q37: 'B', q38: 'B', q39: 'A', q40: 'B', // Note: Q38 answer in the original HTML was B, which matches the text description.
             q41: 'C', q42: 'B', q43: 'B', q44: 'B', q45: 'B',
             q46: 'C', q47: 'B', q48: 'D', q49: 'C', q50: 'C'
        };

        function checkLogin() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('login-password').value.trim();
            const errorMessage = document.getElementById('login-error');
            const loginSection = document.getElementById('login-section');
            const quizForm = document.getElementById('quiz-form');

            const isValid = validCredentials.some(cred =>
                cred.username === username && cred.password === password
            );

            if (isValid) {
                errorMessage.classList.add('hidden');
                loginSection.classList.add('hidden');
                quizForm.classList.remove('hidden');
            } else {
                errorMessage.classList.remove('hidden');
            }
        }

        function showReview() {
            const form = document.getElementById('mcie-quiz');
            formData = new FormData(form);
            const data = Object.fromEntries(formData);

             // Check if all questions are answered
             let allAnswered = true;
             for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 if (!data[`q${i}`]) {
                     allAnswered = false;
                     break;
                 }
             }

             if (!data.name || !data.id_number || !data.section || !data.email || !data.phone || !allAnswered) {
                 alert('Please fill in all personal information and answer all questions before submitting.');
                 return; // Stop the function if validation fails
             }

            // Store quiz data temporarily
            quizData = {
                name: data.name,
                id_number: data.id_number,
                section: data.section,
                email: data.email,
                phone: data.phone,
                answers: {},
                questions: allQuestionsData, // Use the predefined structure
                chapter: CURRENT_QUIZ_CHAPTER, // Added chapter to quizData
                courseCode: COURSE_CODE // Added course code to quizData
            };

            // Construct the formatted chapter string for display
             const formattedCourseChapter = `${quizData.courseCode} Chapter ${quizData.chapter}`;


            // Populate answers dynamically
            let reviewHTML = `
                <p><strong>Name:</strong> ${data.name}</p>
                <p><strong>ID Number:</strong> ${data.id_number}</p>
                <p><strong>Section:</strong> ${data.section}</p>
                <p><strong>Email:</strong> ${data.email}</p>
                <p><strong>Phone Number:</strong> ${data.phone}</p>
                 <p><strong>Chapter:</strong> ${quizData.chapter}</p>
                 <p><strong>Course & Chapter:</strong> ${formattedCourseChapter}</p> <!-- Added formatted chapter to review display -->
                <hr>
                <h3>Your Answers:</h3>
            `;

            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                const qKey = `q${i}`;
                const userAnswer = data[qKey];
                quizData.answers[qKey] = userAnswer; // Store answer
                const questionInfo = allQuestionsData[qKey];
                const answerText = questionInfo.choices[userAnswer] || 'Not Answered';
                reviewHTML += `<p><strong>Question ${i}:</strong> ${questionInfo.text}<br>Your answer: ${userAnswer}) ${answerText}</p>`;
            }

            // Display review content
            const reviewContent = document.getElementById('review-content');
            reviewContent.innerHTML = reviewHTML;

            // Show review section
            document.getElementById('quiz-form').classList.add('hidden');
            document.getElementById('review-section').classList.remove('hidden');
        }

        function editForm() {
            document.getElementById('review-section').classList.add('hidden');
            document.getElementById('quiz-form').classList.remove('hidden');
        }

        function downloadResponse() {
            if (!quizData) return;

            const doc = new jsPDF();
            let y = 10;
            const pageHeight = doc.internal.pageSize.height;
            const pageWidth = doc.internal.pageSize.width;
            const margin = 10;
            const effectiveWidth = pageWidth - margin * 2;

             const formattedCourseChapter = `${quizData.courseCode} Chapter ${quizData.chapter}`;


            doc.setFontSize(16);
            // Updated Title for PDF
            doc.text(`Logical Reasoning and Fallacies Quiz Response`, pageWidth / 2, y, { align: 'center' }); // Reflects new quiz topic
            y += 10;

            doc.setFontSize(12);
            doc.text(`Name: ${quizData.name}`, margin, y); y += 7;
            doc.text(`ID: ${quizData.id_number}`, margin, y); y += 7;
            doc.text(`Section: ${quizData.section}`, margin, y); y += 7;
            doc.text(`Email: ${quizData.email}`, margin, y); y += 7;
            doc.text(`Phone: ${quizData.phone}`, margin, y); y += 7;
            doc.text(`Chapter: ${quizData.chapter}`, margin, y); y += 7;
            doc.text(`Course & Chapter: ${formattedCourseChapter}`, margin, y); y += 10; // Added formatted chapter to PDF


            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const question = quizData.questions[qKey];
                 const userAnswer = quizData.answers[qKey];
                 const answerText = question.choices[userAnswer] || 'Not Answered';
                 const questionText = question.text;

                 // Estimate space needed for the question + answer
                 const questionLines = doc.splitTextToSize(`Question ${i}: ${questionText}`, effectiveWidth);
                 const answerLines = doc.splitTextToSize(`Your answer: ${userAnswer}) ${answerText}`, effectiveWidth);
                 const spaceNeeded = (questionLines.length * 5) + 2 + (answerLines.length * 5) + 5; // Estimate lines * line height + spacing

                 if (y + spaceNeeded > pageHeight - margin) { // Check if content fits
                    doc.addPage();
                    y = margin;
                 }

                doc.setFont('helvetica', 'bold');
                doc.text(questionLines, margin, y);
                y += (questionLines.length * 5) + 2;
                doc.setFont('helvetica', 'normal');

                if (y > pageHeight - margin) { doc.addPage(); y = margin; }

                doc.text(answerLines, margin, y);
                y += (answerLines.length * 5) + 5;

            }

            // Updated filename using formatted chapter string
            doc.save(`${formattedCourseChapter.replace(/ /g, '_')}_response_${quizData.id_number}.pdf`);
        }

        // --- MODIFIED: confirmSubmission Function ---
        async function confirmSubmission() {
            if (confirm('Are you sure you want to submit your answers?')) {
                if (!quizData || !formData) {
                     console.error("Quiz data or form data is missing.");
                     alert("Error: Cannot submit. Please try filling the form again.");
                     editForm(); // Go back to edit
                     return;
                }

                const data = Object.fromEntries(formData); // Use the stored formData

                // Calculate score
                let score = 0;
                for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                    const qKey = `q${i}`;
                    if (data[qKey] === correctAnswersMap[qKey]) {
                        score++;
                    }
                }

                // Update quizData with score (Optional but good practice)
                quizData.score = score;

                // *** CONSTRUCT THE FORMATTED CHAPTER STRING ***
                const formattedCourseChapter = `${COURSE_CODE} Chapter ${CURRENT_QUIZ_CHAPTER}`;


                // Prepare data for YOUR backend
                const submissionData = {
                    name: data.name,
                    id_number: data.id_number,
                    section: data.section,
                    email: data.email,
                    phone: data.phone,
                    score: score,
                    totalQuestions: TOTAL_QUESTIONS,
                    quizChapter: CURRENT_QUIZ_CHAPTER, // Keep the integer (5)
                    // *** ADDED SPECIFIC QUIZ TITLE ***
                    quizTitle: `Logical Reasoning and Fallacies Quiz - Chapter ${CURRENT_QUIZ_CHAPTER}`,
                    // submittedAt: new Date().toISOString(), // Add if needed by backend
                    // answers: quizData.answers // Add if needed by backend

                    // *** ADD THE NEW FIELD WITH THE FORMATTED STRING ***
                    course_chapter_formatted: formattedCourseChapter,
                };

                console.log("Submitting quiz data:", submissionData);

                try {
                    // Show "Submitting..." message or spinner here if desired

                    const response = await fetch('/submit-quiz', { // Point to your backend endpoint
                        method: 'POST',
                        body: JSON.stringify(submissionData), // Send the data as JSON
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json' // Important Header!
                        }
                    });

                    if (response.ok) {
                        const result = await response.json();
                        console.log('Submission successful:', result);
                        alert("Quiz submitted successfully!"); // Provide feedback to user

                        // Show submission copy
                        const submissionContent = document.getElementById('submission-content');
                         let submissionHTML = `
                            <p><strong>Name:</strong> ${quizData.name}</p>
                            <p><strong>ID Number:</strong> ${quizData.id_number}</p>
                            <p><strong>Section:</strong> ${quizData.section}</p>
                            <p><strong>Email:</strong> ${quizData.email}</p>
                            <p><strong>Phone Number:</strong> ${quizData.phone}</p>
                            <p><strong>Chapter:</strong> ${quizData.chapter}</p>
                             <p><strong>Course & Chapter:</strong> ${formattedCourseChapter}</p> <!-- Added formatted chapter to submission copy -->
                            <hr>
                            <h3>Submitted Answers:</h3>
                        `;
                         for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                             const qKey = `q${i}`;
                             const questionInfo = quizData.questions[qKey];
                             const userAnswer = quizData.answers[qKey];
                             const answerText = questionInfo.choices[userAnswer] || 'Not Answered';
                             submissionHTML += `<p><strong>Question ${i}:</strong> ${questionInfo.text}<br>Your answer: ${userAnswer}) ${answerText}</p>`;
                         }
                        submissionContent.innerHTML = submissionHTML;

                        document.getElementById('review-section').classList.add('hidden');
                        document.getElementById('submission-copy').classList.remove('hidden');


                    } else {
                        let errorMsg = `Submission failed with status: ${response.status}`;
                        try {
                            const errorData = await response.json();
                            errorMsg = errorData.error || errorData.message || errorMsg;
                        } catch(e) { /* Ignore if response isn't JSON */ }

                        console.error('Backend submission error:', errorMsg);
                        document.getElementById('error-message').innerHTML = `<p>Submission failed: ${errorMsg}. Please try again.</p>`;
                        document.getElementById('error-message').classList.remove('hidden');
                        document.getElementById('review-section').classList.add('hidden');
                    }
                } catch (error) {
                    console.error('Network/Fetch error:', error);
                    document.getElementById('error-message').innerHTML = `<p>An network error occurred during submission. Please check your connection and try again.</p>`;
                    document.getElementById('error-message').classList.remove('hidden');
                    document.getElementById('review-section').classList.add('hidden');
                }
            }
        }


        function proceedToPassword() {
            document.getElementById('submission-copy').classList.add('hidden');
            document.getElementById('password-section').classList.remove('hidden');
        }

        function checkPassword() {
            const passwordInput = document.getElementById('password').value;
            const correctPassword = 'password'; // Keep the simple password
            const errorMessage = document.getElementById('password-error');
            const passwordSection = document.getElementById('password-section');
            const results = document.getElementById('results');

            if (passwordInput === correctPassword) {
                errorMessage.classList.add('hidden');
                passwordSection.classList.add('hidden');
                results.classList.remove('hidden');
                displayResults();
            } else {
                errorMessage.classList.remove('hidden');
            }
        }

        function displayResults() {
            if (!quizData) {
                document.getElementById('results').innerHTML = '<p>Error: No quiz data found. Please complete the quiz first.</p>';
                return;
            }

             // Combine correct answer letter with full text for display
             const displayCorrectAnswers = {};
             for(let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const correctLetter = correctAnswersMap[qKey];
                 const correctText = allQuestionsData[qKey].choices[correctLetter];
                 displayCorrectAnswers[qKey] = `${correctLetter}) ${correctText}`; // Changed format slightly
             }

            const formattedCourseChapter = `${quizData.courseCode} Chapter ${quizData.chapter}`;

            // Added formatted chapter to results display
            document.getElementById('student-info').innerHTML = `<strong>Name:</strong> ${quizData.name}<br><strong>ID:</strong> ${quizData.id_number}<br><strong>Section:</strong> ${quizData.section}<br><strong>Email:</strong> ${quizData.email}<br><strong>Phone:</strong> ${quizData.phone}<br><strong>Chapter:</strong> ${quizData.chapter}<br><strong>Course & Chapter:</strong> ${formattedCourseChapter}`;


            const answersDiv = document.getElementById('answers');
            let answersHTML = '<h3>Detailed Results:</h3>';

            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const question = quizData.questions[qKey];
                 const userAnswer = quizData.answers[qKey];
                 const userAnswerText = question.choices[userAnswer] || 'Not Answered';
                 const isCorrect = userAnswer === correctAnswersMap[qKey];

                 answersHTML += `
                    <div class="question-result">
                        <p><strong>Question ${i}:</strong> ${question.text}</p>
                        <div class="choices" style="font-size:0.9em; margin-left: 15px;">
                            <p>A) ${question.choices.A}</p>
                            <p>B) ${question.choices.B}</p>
                            <p>C) ${question.choices.C}</p>
                            <p>D) ${question.choices.D}</p>
                        </div>
                        <p>Your answer: ${userAnswer}) ${userAnswerText} ${isCorrect ? '<span style="color:green; font-weight:bold;">(Correct)</span>' : '<span style="color:red; font-weight:bold;">(Incorrect)</span>'}</p>
                        ${!isCorrect ? `<p style="color:blue;">Correct answer: ${displayCorrectAnswers[qKey]}</p>` : ''}
                    </div>
                `;
            }
            answersDiv.innerHTML = answersHTML;


            document.getElementById('score').textContent = `Final Score: ${quizData.score} / ${TOTAL_QUESTIONS}`;
        }

        // --- Completed downloadPDF Function ---
        function downloadPDF() {
            if (!quizData) return;

            const doc = new jsPDF();
            let y = 10;
            const pageHeight = doc.internal.pageSize.height;
            const pageWidth = doc.internal.pageSize.width;
            const margin = 10;
            const effectiveWidth = pageWidth - margin * 2;

             // Combine correct answer letter with full text for display
             const displayCorrectAnswers = {};
             for(let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const correctLetter = correctAnswersMap[qKey];
                 const correctText = allQuestionsData[qKey].choices[correctLetter];
                 displayCorrectAnswers[qKey] = `${correctLetter}) ${correctText}`;
             }

            const formattedCourseChapter = `${quizData.courseCode} Chapter ${quizData.chapter}`;

            doc.setFontSize(16);
            // Updated Title for PDF
            doc.text(`Logical Reasoning and Fallacies Quiz Results`, pageWidth / 2, y, { align: 'center' }); // Reflects new topic
            y += 10;

            doc.setFontSize(12);
            doc.text(`Name: ${quizData.name}`, margin, y); y += 7;
            doc.text(`ID: ${quizData.id_number}`, margin, y); y += 7;
            doc.text(`Section: ${quizData.section}`, margin, y); y += 7;
            doc.text(`Email: ${quizData.email}`, margin, y); y += 7;
            doc.text(`Phone: ${quizData.phone}`, margin, y); y += 7;
             // Added formatted chapter to PDF
            doc.text(`Course & Chapter: ${formattedCourseChapter}`, margin, y); y += 10;


            doc.setFont('helvetica', 'bold');
            doc.text(`Final Score: ${quizData.score} / ${TOTAL_QUESTIONS}`, pageWidth / 2, y, { align: 'center' });
            y += 10;
            doc.setFont('helvetica', 'normal');


            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const question = quizData.questions[qKey];
                 const userAnswer = quizData.answers[qKey];
                 const userAnswerText = question.choices[userAnswer] || 'Not Answered';
                 const isCorrect = userAnswer === correctAnswersMap[qKey];
                 const questionText = question.text;
                 const correctAnswerFull = displayCorrectAnswers[qKey];

                 // Estimate space needed
                 const qLines = doc.splitTextToSize(`Question ${i}: ${questionText}`, effectiveWidth);
                 const choicesLinesHeight = 4 * 5; // Estimate height for 4 choices
                 const yourAnsLines = doc.splitTextToSize(`Your answer: ${userAnswer}) ${userAnswerText} ${isCorrect ? '(Correct)' : '(Incorrect)'}`, effectiveWidth);
                 const correctAnsLinesHeight = isCorrect ? 0 : doc.splitTextToSize(`Correct answer: ${correctAnswerFull}`, effectiveWidth).length * 5; // Height needed for correct answer if wrong
                 const spaceNeeded = (qLines.length * 5) + 2 + choicesLinesHeight + 7 + (yourAnsLines.length * 5) + 7 + correctAnsLinesHeight + 5;


                 if (y + spaceNeeded > pageHeight - margin) {
                    doc.addPage();
                    y = margin;
                }

                doc.setFont('helvetica', 'bold');
                doc.text(qLines, margin, y);
                y += (qLines.length * 5) + 2;
                doc.setFont('helvetica', 'normal');

                 const remainingSpaceAfterQuestion = pageHeight - margin - y;
                 const answersSectionSpace = choicesLinesHeight + 7 + (yourAnsLines.length * 5) + 7 + correctAnsLinesHeight + 5;

                 // Prevent choices/answers from being split awkwardly if possible
                 if (answersSectionSpace > remainingSpaceAfterQuestion) {
                     doc.addPage();
                     y = margin;
                 }


                doc.setFontSize(10);
                doc.text(`  A) ${question.choices.A}`, margin + 5, y); y += 5;
                doc.text(`  B) ${question.choices.B}`, margin + 5, y); y += 5;
                doc.text(`  C) ${question.choices.C}`, margin + 5, y); y += 5;
                doc.text(`  D) ${question.choices.D}`, margin + 5, y); y += 7;
                doc.setFontSize(12);


                doc.text(`Your answer: ${userAnswer}) ${userAnswerText} ${isCorrect ? '(Correct)' : '(Incorrect)'}`, margin, y); y += 7;

                if (!isCorrect) {
                    doc.setTextColor(0, 0, 255);
                    doc.text(`Correct answer: ${correctAnswerFull}`, margin, y); y += 7;
                    doc.setTextColor(0, 0, 0);
                }
                y += 5; // Space before next question

            }

            // Add score again at the end if needed
            if (y > pageHeight - margin) { doc.addPage(); y = margin; }
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(14);
            doc.text(`Final Score: ${quizData.score} / ${TOTAL_QUESTIONS}`, pageWidth / 2, y, { align: 'center' });

            // Updated filename to include formatted chapter
            doc.save(`${formattedCourseChapter.replace(/ /g, '_')}_results_${quizData.id_number}.pdf`);
        }
    </script>
</body>
</html>

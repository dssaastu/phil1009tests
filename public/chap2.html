<!DOCTYPE html>
<html lang="en">
<head>
    <!-- IMPORTANT: Make sure your text editor saves this file with UTF-8 Encoding! -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basic Concepts of Logic Quiz</title> <!-- Changed Title -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"], input[type="email"], input[type="tel"], input[type="password"] { width: 100%; padding: 8px; box-sizing: border-box; }
        input[type="radio"] { margin-right: 5px; }
        button { padding: 10px 20px; background-color: #007bff; color: white; border: none; cursor: pointer; margin-right: 10px; border-radius: 5px; }
        button:hover { background-color: #0056b3; }
        .hidden { display: none; }
        #error-message, #password-error, #login-error { color: red; font-size: 1.2em; text-align: center; }
        #success-message { color: green; font-size: 1.2em; text-align: center; }
        #results, #review-section, #submission-copy { margin-top: 20px; text-align: left; border: 1px solid #ccc; padding: 15px; border-radius: 5px; background-color: #f9f9f9;}
        #password-section, #login-section { text-align: center; max-width: 400px; margin: 20px auto; padding: 20px; border: 1px solid #ccc; border-radius: 5px; background-color: #f9f9f9;}
        #password-section input[type="password"], #login-section input[type="text"], #login-section input[type="password"] { width: calc(100% - 18px); }
        .question-result { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee; }
        #download-pdf, #download-response { margin-top: 10px; }
        #score { font-weight: bold; text-align: center; color: green; font-size: 1.4em; margin-top: 20px; }
        #review-section h2, #submission-copy h2, #results h1 { margin-bottom: 15px; text-align: center; color: #007bff;}
        #review-section button, #submission-copy button, #password-section button, #login-section button, #results button { margin-top: 15px; }
        .choices p { margin: 2px 0 2px 20px; }
    </style>
</head>
<body>
    <div id="login-section">
        <h1>Login to Access Quiz</h1>
        <div class="form-group">
            <label for="username">Username:</label>
            <input type="text" id="username" placeholder="Enter username" required>
        </div>
        <div class="form-group">
            <label for="login-password">Password:</label>
            <input type="password" id="login-password" placeholder="Enter password" required>
        </div>
        <button onclick="checkLogin()">Login</button>
        <p id="login-error" class="hidden">Incorrect username or password. Please try again.</p>
    </div>

    <div id="quiz-form" class="hidden">
        <h1>Basic Concepts of Logic Quiz - Chapter 2</h1> <!-- Changed Title -->
        <form id="mcie-quiz"> <!-- ID Kept, but content changed -->
            <!-- Student Information -->
            <div class="form-group">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="id_number">ID Number:</label>
                <input type="text" id="id_number" name="id_number" required>
            </div>
            <div class="form-group">
                <label for="section">Section:</label>
                <input type="text" id="section" name="section" required>
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required>
            </div>
            <div class="form-group">
                <label for="phone">Phone Number:</label>
                <input type="tel" id="phone" name="phone" required>
            </div>

            <!-- Basic Concepts of Logic Multiple-Choice Questions -->
            <div class="form-group">
                <label>1. Logic, as a field of study, is primarily defined as the science that:</label>
                <input type="radio" name="q1" value="A" required> A) Discovers new facts about the world.<br>
                <input type="radio" name="q1" value="B"> B) Evaluates arguments.<br>
                <input type="radio" name="q1" value="C"> C) Studies the history of philosophy.<br>
                <input type="radio" name="q1" value="D"> D) Develops rhetorical techniques.
            </div>
            <div class="form-group">
                <label>2. An argument, in the logical sense, is a systematic combination of statements where:</label>
                <input type="radio" name="q2" value="A" required> A) People disagree verbally.<br>
                <input type="radio" name="q2" value="B"> B) One or more statements (premises) are claimed to support another (conclusion).<br>
                <input type="radio" name="q2" value="C"> C) All statements are guaranteed to be true.<br>
                <input type="radio" name="q2" value="D"> D) Emotions are used to persuade an audience.
            </div>
            <div class="form-group">
                <label>3. A premise is a statement within an argument that:</label>
                <input type="radio" name="q3" value="A" required> A) Is the main point the argument tries to establish.<br>
                <input type="radio" name="q3" value="B"> B) Is always factually correct.<br>
                <input type="radio" name="q3" value="C"> C) Is claimed to provide support or evidence for the conclusion.<br>
                <input type="radio" name="q3" value="D"> D) Must contain an indicator word like "therefore".
            </div>
            <div class="form-group">
                <label>4. A conclusion is a statement within an argument that:</label>
                <input type="radio" name="q4" value="A" required> A) Is claimed to follow from the alleged evidence (premises).<br>
                <input type="radio" name="q4" value="B"> B) Must appear last in the passage.<br>
                <input type="radio" name="q4" value="C"> C) Is always presented as a question.<br>
                <input type="radio" name="q4" value="D"> D) Provides the reasons or evidence.
            </div>
            <div class="form-group">
                <label>5. A statement is defined as a declarative sentence that:</label>
                <input type="radio" name="q5" value="A" required> A) Expresses a strong feeling.<br>
                <input type="radio" name="q5" value="B"> B) Gives a command or order.<br>
                <input type="radio" name="q5" value="C"> C) Has a truth-value (is either true or false).<br>
                <input type="radio" name="q5" value="D"> D) Asks a question.
            </div>
            <div class="form-group">
                <label>6. Which of the following is NOT a statement?</label>
                <input type="radio" name="q6" value="A" required> A) Mekelle is the capital city of Tigray Region.<br>
                <input type="radio" name="q6" value="B"> B) Would you close the window?<br>
                <input type="radio" name="q6" value="C"> C) Ethiopia was colonized by Germany.<br>
                <input type="radio" name="q6" value="D"> D) Dr. Abiy Ahmed is the current Prime Minister of Ethiopia.
            </div>
            <div class="form-group">
                <label>7. The primary aim of logic is to develop methods and principles used for:</label>
                <input type="radio" name="q7" value="A" required> A) Winning debates regardless of truth.<br>
                <input type="radio" name="q7" value="B"> B) Understanding historical events.<br>
                <input type="radio" name="q7" value="C"> C) Evaluating arguments and constructing good arguments.<br>
                <input type="radio" name="q7" value="D"> D) Expressing personal beliefs clearly.
            </div>
            <div class="form-group">
                <label>8. One of the major benefits of studying logic is:</label>
                <input type="radio" name="q8" value="A" required> A) Ensuring one always holds popular opinions.<br>
                <input type="radio" name="q8" value="B"> B) Developing the skill to construct sound, fallacy-free arguments.<br>
                <input type="radio" name="q8" value="C"> C) Learning how to avoid all disagreements.<br>
                <input type="radio" name="q8" value="D"> D) Memorizing the arguments of famous philosophers.
            </div>
            <div class="form-group">
                <label>9. Indicator words like "therefore," "thus," and "consequently" typically signal:</label>
                <input type="radio" name="q9" value="A" required> A) A premise.<br>
                <input type="radio" name="q9" value="B"> B) A conclusion.<br>
                <input type="radio" name="q9" value="C"> C) A non-argumentative passage.<br>
                <input type="radio" name="q9" value="D"> D) An explanation.
            </div>
            <div class="form-group">
                <label>10. Indicator words like "since," "because," and "for" typically signal:</label>
                <input type="radio" name="q10" value="A" required> A) A conclusion.<br>
                <input type="radio" name="q10" value="B"> B) A conditional statement.<br>
                <input type="radio" name="q10" value="C"> C) A premise.<br>
                <input type="radio" name="q10" value="D"> D) A report.
            </div>
            <div class="form-group">
                <label>11. If an argument contains no indicator words, how might the conclusion often be identified?</label>
                <input type="radio" name="q11" value="A" required> A) It is always the longest sentence.<br>
                <input type="radio" name="q11" value="B"> B) It is usually the first statement in the passage.<br>
                <input type="radio" name="q11" value="C"> C) It is the statement the arguer is trying to prove or establish as the main point.<br>
                <input type="radio" name="q11" value="D"> D) It must be a universally accepted fact.
            </div>
            <div class="form-group">
                <label>12. For a passage to contain an argument, it must fulfill two conditions: at least one statement must claim to present evidence/reasons, and:</label>
                <input type="radio" name="q12" value="A" required> A) All statements must be true.<br>
                <input type="radio" name="q12" value="B"> B) There must be at least five sentences.<br>
                <input type="radio" name="q12" value="C"> C) There must be a claim that this evidence supports or implies something (an inferential claim).<br>
                <input type="radio" name="q12" value="D"> D) It must contain conclusion indicator words.
            </div>
            <div class="form-group">
                <label>13. The claim that the premises support or imply the conclusion is known as the:</label>
                <input type="radio" name="q13" value="A" required> A) Factual claim.<br>
                <input type="radio" name="q13" value="B"> B) Inferential claim.<br>
                <input type="radio" name="q13" value="C"> C) Conditional claim.<br>
                <input type="radio" name="q13" value="D"> D) Declarative claim.
            </div>
            <div class="form-group">
                <label>14. An explicit inferential claim is typically asserted by:</label>
                <input type="radio" name="q14" value="A" required> A) The context of the passage alone.<br>
                <input type="radio" name="q14" value="B"> B) The emotional tone of the language.<br>
                <input type="radio" name="q14" value="C"> C) Premise or conclusion indicator words.<br>
                <input type="radio" name="q14" value="D"> D) The truth-value of the statements.
            </div>
            <div class="form-group">
                <label>15. An implicit inferential claim exists when:</label>
                <input type="radio" name="q15" value="A" required> A) There are indicator words present.<br>
                <input type="radio" name="q15" value="B"> B) The passage is purely descriptive.<br>
                <input type="radio" name="q15" value="C"> C) There is an inferential relationship between statements, but no indicator words.<br>
                <input type="radio" name="q15" value="D"> D) The author explicitly states their intentions.
            </div>
            <div class="form-group">
                <label>16. The mere presence of an indicator word like "since" guarantees:</label>
                <input type="radio" name="q16" value="A" required> A) The passage is a strong argument.<br>
                <input type="radio" name="q16" value="B"> B) The passage is a valid argument.<br>
                <input type="radio" name="q16" value="C"> C) The passage contains an argument.<br>
                <input type="radio" name="q16" value="D"> D) Nothing; its function (temporal or logical) must be determined from context.
            </div>
            <div class="form-group">
                <label>17. Passages such as warnings, pieces of advice, and statements of belief often lack:</label>
                <input type="radio" name="q17" value="A" required> A) Statements.<br>
                <input type="radio" name="q17" value="B"> B) Truth-value.<br>
                <input type="radio" name="q17" value="C"> C) An inferential claim.<br>
                <input type="radio" name="q17" value="D"> D) Any clear subject matter.
            </div>
            <div class="form-group">
                <label>18. An expository passage, which starts with a topic sentence and develops it, is considered an argument only if:</label>
                <input type="radio" name="q18" value="A" required> A) It contains the word "because".<br>
                <input type="radio" name="q18" value="B"> B) The subsequent sentences aim to prove the topic sentence, not just elaborate on it.<br>
                <input type="radio" name="q18" value="C"> C) The topic sentence is a question.<br>
                <input type="radio" name="q18" value="D"> D) It is written by a famous author.
            </div>
            <div class="form-group">
                <label>19. An illustration using examples is considered an argument (an argument from example) when:</label>
                <input type="radio" name="q19" value="A" required> A) It uses the indicator word "thus".<br>
                <input type="radio" name="q19" value="B"> B) It merely shows what something means or how it is done.<br>
                <input type="radio" name="q19" value="C"> C) The examples are intended to prove the truth of a more general claim.<br>
                <input type="radio" name="q19" value="D"> D) The examples are very detailed.
            </div>
            <div class="form-group">
                <label>20. An explanation differs from an argument in that its primary purpose is typically to:</label>
                <input type="radio" name="q20" value="A" required> A) Prove that a certain event occurred.<br>
                <input type="radio" name="q20" value="B"> B) Shed light on why an accepted event occurred or why something is the case.<br>
                <input type="radio" name="q20" value="C"> C) Persuade the audience to take action.<br>
                <input type="radio" name="q20" value="D"> D) Present a sequence of historical facts.
            </div>
            <div class="form-group">
                <label>21. In an explanation, the statement describing the event to be explained is the ________, and the statement(s) doing the explaining is/are the ________.</label>
                <input type="radio" name="q21" value="A" required> A) Premise; Conclusion<br>
                <input type="radio" name="q21" value="B"> B) Conclusion; Premise<br>
                <input type="radio" name="q21" value="C"> C) Explanandum; Explanans<br>
                <input type="radio" name="q21" value="D"> D) Explanans; Explanandum
            </div>
            <div class="form-group">
                <label>22. A single conditional statement ("If P, then Q") is not an argument because:</label>
                <input type="radio" name="q22" value="A" required> A) It always contains false statements.<br>
                <input type="radio" name="q22" value="B"> B) It doesn't assert that either the antecedent (P) or the consequent (Q) is true.<br>
                <input type="radio" name="q22" value="C"> C) It cannot contain indicator words.<br>
                <input type="radio" name="q22" value="D"> D) It only expresses opinions.
            </div>
            <div class="form-group">
                <label>23. In the conditional statement "If it rains, then the ground is wet," the antecedent is:</label>
                <input type="radio" name="q23" value="A" required> A) The ground is wet.<br>
                <input type="radio" name="q23" value="B"> B) If it rains.<br>
                <input type="radio" name="q23" value="C"> C) It rains.<br>
                <input type="radio" name="q23" value="D"> D) Then the ground is wet.
            </div>
            <div class="form-group">
                <label>24. Being a dog is a ________ condition for being an animal.</label>
                <input type="radio" name="q24" value="A" required> A) Necessary<br>
                <input type="radio" name="q24" value="B"> B) Sufficient<br>
                <input type="radio" name="q24" value="C"> C) Necessary and sufficient<br>
                <input type="radio" name="q24" value="D"> D) Neither necessary nor sufficient
            </div>
            <div class="form-group">
                <label>25. Being an animal is a ________ condition for being a dog.</label>
                <input type="radio" name="q25" value="A" required> A) Necessary<br>
                <input type="radio" name="q25" value="B"> B) Sufficient<br>
                <input type="radio" name="q25" value="C"> C) Necessary and sufficient<br>
                <input type="radio" name="q25" value="D"> D) Neither necessary nor sufficient
            </div>
            <div class="form-group">
                <label>26. A deductive argument is one where the premises are claimed to support the conclusion such that:</label>
                <input type="radio" name="q26" value="A" required> A) The conclusion is probably true if the premises are true.<br>
                <input type="radio" name="q26" value="B"> B) It is impossible for the conclusion to be false if the premises are true.<br>
                <input type="radio" name="q26" value="C"> C) The premises cause the conclusion to occur.<br>
                <input type="radio" name="q26" value="D"> D) The argument uses statistical reasoning.
            </div>
            <div class="form-group">
                <label>27. An inductive argument is one where the premises are claimed to support the conclusion such that:</label>
                <input type="radio" name="q27" value="A" required> A) It is impossible for the conclusion to be false if the premises are true.<br>
                <input type="radio" name="q27" value="B"> B) The conclusion contains less information than the premises.<br>
                <input type="radio" name="q27" value="C"> C) It is improbable for the conclusion to be false if the premises are true.<br>
                <input type="radio" name="q27" value="D"> D) The argument form is always a syllogism.
            </div>
            <div class="form-group">
                <label>28. The distinction between deductive and inductive arguments lies primarily in:</label>
                <input type="radio" name="q28" value="A" required> A) The number of premises.<br>
                <input type="radio" name="q28" value="B"> B) The truth value of the conclusion.<br>
                <input type="radio" name="q28" value="C"> C) The strength of the argument's inferential claim.<br>
                <input type="radio" name="q28" value="D"> D) Whether the argument contains indicator words.
            </div>
            <div class="form-group">
                <label>29. Which factor is NOT listed as influencing the decision about whether an argument is deductive or inductive?</label>
                <input type="radio" name="q29" value="A" required> A) The occurrence of special indicator words (e.g., "necessarily", "probably").<br>
                <input type="radio" name="q29" value="B"> B) The actual strength of the inferential link.<br>
                <input type="radio" name="q29" value="C"> C) The character or form of argumentation used.<br>
                <input type="radio" name="q29" value="D"> D) The emotional appeal of the conclusion.
            </div>
            <div class="form-group">
                <label>30. Arguments based on mathematics (excluding statistics) are generally interpreted as:</label>
                <input type="radio" name="q30" value="A" required> A) Inductive.<br>
                <input type="radio" name="q30" value="B"> B) Deductive.<br>
                <input type="radio" name="q30" value="C"> C) Explanations.<br>
                <input type="radio" name="q30" value="D"> D) Conditional statements.
            </div>
            <div class="form-group">
                <label>31. An argument where the conclusion depends merely on the definition of a word used in the premise (e.g., "Kebede is a bachelor, therefore Kebede is unmarried") is typically:</label>
                <input type="radio" name="q31" value="A" required> A) Inductive.<br>
                <input type="radio" name="q31" value="B"> B) An argument from analogy.<br>
                <input type="radio" name="q31" value="C"> C) Deductive.<br>
                <input type="radio" name="q31" value="D"> D) A causal inference.
            </div>
            <div class="form-group">
                <label>32. A syllogism having a conditional statement ("If...then...") for one or both of its premises is known as a:</label>
                <input type="radio" name="q32" value="A" required> A) Categorical syllogism.<br>
                <input type="radio" name="q32" value="B"> B) Disjunctive syllogism.<br>
                <input type="radio" name="q32" value="C"> C) Hypothetical syllogism.<br>
                <input type="radio" name="q32" value="D"> D) Inductive generalization.
            </div>
            <div class="form-group">
                <label>33. A syllogism having a disjunctive statement ("Either...or...") is known as a:</label>
                <input type="radio" name="q33" value="A" required> A) Categorical syllogism.<br>
                <input type="radio" name="q33" value="B"> B) Disjunctive syllogism.<br>
                <input type="radio" name="q33" value="C"> C) Hypothetical syllogism.<br>
                <input type="radio" name="q33" value="D"> D) Prediction.
            </div>
            <div class="form-group">
                <label>34. An argument that proceeds from the knowledge of a selected sample to a claim about the whole group is a(n):</label>
                <input type="radio" name="q34" value="A" required> A) Argument from definition.<br>
                <input type="radio" name="q34" value="B"> B) Inductive generalization.<br>
                <input type="radio" name="q34" value="C"> C) Deductive syllogism.<br>
                <input type="radio" name="q34" value="D"> D) Argument based on mathematics.
            </div>
            <div class="form-group">
                <label>35. An argument that concludes something about the future based on knowledge of the present or past is a(n):</label>
                <input type="radio" name="q35" value="A" required> A) Argument from definition.<br>
                <input type="radio" name="q35" value="B"> B) Disjunctive syllogism.<br>
                <input type="radio" name="q35" value="C"> C) Prediction.<br>
                <input type="radio" name="q35" value="D"> D) Argument based on mathematics.
            </div>
            <div class="form-group">
                <label>36. An argument that depends on the existence of a similarity between two things or states of affairs is a(n):</label>
                <input type="radio" name="q36" value="A" required> A) Argument from analogy.<br>
                <input type="radio" name="q36" value="B"> B) Categorical syllogism.<br>
                <input type="radio" name="q36" value="C"> C) Argument from definition.<br>
                <input type="radio" name="q36" value="D"> D) Causal inference.
            </div>
            <div class="form-group">
                <label>37. An argument where the conclusion rests on a statement made by a presumed authority or witness is a(n):</label>
                <input type="radio" name="q37" value="A" required> A) Argument based on mathematics.<br>
                <input type="radio" name="q37" value="B"> B) Argument from authority.<br>
                <input type="radio" name="q37" value="C"> C) Argument from definition.<br>
                <input type="radio" name="q37" value="D"> D) Hypothetical syllogism.
            </div>
            <div class="form-group">
                <label>38. The traditional view that induction proceeds from particular to general and deduction from general to particular is:</label>
                <input type="radio" name="q38" value="A" required> A) Always accurate and the best way to distinguish them.<br>
                <input type="radio" name="q38" value="B"> B) Largely incorrect, as examples exist that contradict this pattern for both types.<br>
                <input type="radio" name="q38" value="C"> C) Accurate only for arguments in mathematics.<br>
                <input type="radio" name="q38" value="D"> D) The only definition provided in the text.
            </div>
            <div class="form-group">
                <label>39. A valid deductive argument is one where:</label>
                <input type="radio" name="q39" value="A" required> A) All the premises are true.<br>
                <input type="radio" name="q39" value="B"> B) The conclusion is true.<br>
                <input type="radio" name="q39" value="C"> C) If the premises are assumed true, it is impossible for the conclusion to be false.<br>
                <input type="radio" name="q39" value="D"> D) The conclusion is probably true given the premises.
            </div>
            <div class="form-group">
                <label>40. An invalid deductive argument is one where:</label>
                <input type="radio" name="q40" value="A" required> A) All the premises are false.<br>
                <input type="radio" name="q40" value="B"> B) The conclusion is false.<br>
                <input type="radio" name="q40" value="C"> C) It is possible for the conclusion to be false even if the premises are assumed true.<br>
                <input type="radio" name="q40" value="D"> D) The argument contains indicator words.
            </div>
            <div class="form-group">
                <label>41. Which combination of truth values is impossible for a valid deductive argument?</label>
                <input type="radio" name="q41" value="A" required> A) True premises, True conclusion.<br>
                <input type="radio" name="q41" value="B"> B) False premises, True conclusion.<br>
                <input type="radio" name="q41" value="C"> C) False premises, False conclusion.<br>
                <input type="radio" name="q41" value="D"> D) True premises, False conclusion.
            </div>
            <div class="form-group">
                <label>42. Validity is determined primarily by:</label>
                <input type="radio" name="q42" value="A" required> A) The actual truth or falsity of the premises.<br>
                <input type="radio" name="q42" value="B"> B) The actual truth or falsity of the conclusion.<br>
                <input type="radio" name="q42" value="C"> C) The inferential relationship or connection between premises and conclusion.<br>
                <input type="radio" name="q42" value="D"> D) The number of statements in the argument.
            </div>
            <div class="form-group">
                <label>43. A sound deductive argument is defined as an argument that is:</label>
                <input type="radio" name="q43" value="A" required> A) Valid and has a true conclusion.<br>
                <input type="radio" name="q43" value="B"> B) Invalid but has true premises.<br>
                <input type="radio" name="q43" value="C"> C) Valid and has all true premises.<br>
                <input type="radio" name="q43" value="D"> D) Persuasive to the audience.
            </div>
            <div class="form-group">
                <label>44. An unsound deductive argument is one that is:</label>
                <input type="radio" name="q44" value="A" required> A) Valid but has false premises.<br>
                <input type="radio" name="q44" value="B"> B) Invalid.<br>
                <input type="radio" name="q44" value="C"> C) Invalid with false premises.<br>
                <input type="radio" name="q44" value="D"> D) Any of the above (Invalid OR Valid with one or more false premise OR both).
            </div>
            <div class="form-group">
                <label>45. A strong inductive argument is one where:</label>
                <input type="radio" name="q45" value="A" required> A) The conclusion follows with strict necessity from the premises.<br>
                <input type="radio" name="q45" value="B"> B) If the premises are assumed true, the conclusion is improbable.<br>
                <input type="radio" name="q45" value="C"> C) If the premises are assumed true, the conclusion is probable.<br>
                <input type="radio" name="q45" value="D"> D) All the premises are known to be true.
            </div>
            <div class="form-group">
                <label>46. A weak inductive argument is one where:</label>
                <input type="radio" name="q46" value="A" required> A) The conclusion is definitely false.<br>
                <input type="radio" name="q46" value="B"> B) If the premises are assumed true, the conclusion does not follow probably.<br>
                <input type="radio" name="q46" value="C"> C) The premises are all false.<br>
                <input type="radio" name="q46" value="D"> D) It contains fewer than three premises.
            </div>
            <div class="form-group">
                <label>47. Unlike validity/invalidity, the strength/weakness of inductive arguments:</label>
                <input type="radio" name="q47" value="A" required> A) Is absolute (no degrees).<br>
                <input type="radio" name="q47" value="B"> B) Admits of degrees.<br>
                <input type="radio" name="q47" value="C"> C) Depends only on the conclusion's truth value.<br>
                <input type="radio" name="q47" value="D"> D) Is irrelevant to argument evaluation.
            </div>
            <div class="form-group">
                <label>48. Which combination of truth values guarantees that an inductive argument is weak?</label>
                <input type="radio" name="q48" value="A" required> A) True premises, True conclusion.<br>
                <input type="radio" name="q48" value="B"> B) False premises, True conclusion.<br>
                <input type="radio" name="q48" value="C"> C) False premises, False conclusion.<br>
                <input type="radio" name="q48" value="D"> D) True premises, False conclusion.
            </div>
            <div class="form-group">
                <label>49. A cogent inductive argument is defined as an argument that is:</label>
                <input type="radio" name="q49" value="A" required> A) Strong and has a probably true conclusion.<br>
                <input type="radio" name="q49" value="B"> B) Weak but has true premises.<br>
                <input type="radio" name="q49" value="C"> C) Strong and has all true premises (and considers all relevant evidence).<br>
                <input type="radio" name="q49" value="D"> D) Valid and has true premises.
            </div>
            <div class="form-group">
                <label>50. An uncogent inductive argument is one that is:</label>
                <input type="radio" name="q50" value="A" required> A) Strong but has false premises.<br>
                <input type="radio" name="q50" value="B"> B) Weak.<br>
                <input type="radio" name="q50" value="C"> C) Weak with false premises.<br>
                <input type="radio" name="q50" value="D"> D) Any of the above (Weak OR Strong with one or more false premise OR both).
            </div>

            <button type="button" onclick="showReview()">Submit</button>
        </form>
        <div id="error-message" class="hidden">
            <p>Something went wrong. Please try again.</p>
        </div>
    </div>

    <div id="review-section" class="hidden">
        <h2>Review Your Answers</h2>
        <div id="review-content"></div>
        <button onclick="editForm()">Edit</button>
        <button onclick="downloadResponse()" id="download-response">Download My Response</button>
        <button onclick="confirmSubmission()">Confirm Submission</button>
    </div>

    <div id="submission-copy" class="hidden">
        <h2>Your Submitted Answers</h2>
        <div id="submission-content"></div>
        <button onclick="proceedToPassword()">Proceed</button>
    </div>

    <div id="password-section" class="hidden">
        <h1 id="success-message">Your response has been submitted</h1>
        <p>You can view your result (score) by entering the password.</p>
        <input type="password" id="password" placeholder="Enter password">
        <button onclick="checkPassword()">Submit</button>
        <p id="password-error" class="hidden">Incorrect password. Please try again.</p>
    </div>

    <div id="results" class="hidden">
        <h1>Quiz Results</h1>
        <p id="student-info"></p>
        <div id="answers"></div>
        <p id="score"></p>
        <button id="download-pdf" onclick="downloadPDF()">Download Results PDF</button>
    </div>

        <script>
        let quizData = null;
        let formData = null;
        const { jsPDF } = window.jspdf;
        const TOTAL_QUESTIONS = 50; // Total number of questions

        // *** ADD/UPDATE THIS LINE - SET CHAPTER TO 2 ***
        // Define the chapter number for THIS specific quiz file (Chapter 2)
        const CURRENT_QUIZ_CHAPTER = 2;

        // *** ADD/UPDATE THIS LINE - DEFINE COURSE CODE ***
        const COURSE_CODE = 'PHIL1009'; // Course code updated to PHIL1009

        // Valid login credentials (Remains the same)
        const validCredentials = [
            { username: 'section19', password: '123' },
            { username: 'section20', password: '123' },
            { username: 'muzemuza', password: 'moh' },
            { username: 'section21', password: '123' }
            // Add more valid credentials as needed
        ];

        // Structure holding question texts and choices (Matches the HTML form questions)
        const allQuestionsData = {
             q1: { text: 'Logic, as a field of study, is primarily defined as the science that:', choices: { A: 'Discovers new facts about the world.', B: 'Evaluates arguments.', C: 'Studies the history of philosophy.', D: 'Develops rhetorical techniques.' } },
             q2: { text: 'An argument, in the logical sense, is a systematic combination of statements where:', choices: { A: 'People disagree verbally.', B: 'One or more statements (premises) are claimed to support another (conclusion).', C: 'All statements are guaranteed to be true.', D: 'Emotions are used to persuade an audience.' } },
             q3: { text: 'A premise is a statement within an argument that:', choices: { A: 'Is the main point the argument tries to establish.', B: 'Is always factually correct.', C: 'Is claimed to provide support or evidence for the conclusion.', D: 'Must contain an indicator word like "therefore".' } },
             q4: { text: 'A conclusion is a statement within an argument that:', choices: { A: 'Is claimed to follow from the alleged evidence (premises).', B: 'Must appear last in the passage.', C: 'Is always presented as a question.', D: 'Provides the reasons or evidence.' } },
             q5: { text: 'A statement is defined as a declarative sentence that:', choices: { A: 'Expresses a strong feeling.', B: 'Gives a command or order.', C: 'Has a truth-value (is either true or false).', D: 'Asks a question.' } },
             q6: { text: 'Which of the following is NOT a statement?', choices: { A: 'Mekelle is the capital city of Tigray Region.', B: 'Would you close the window?', C: 'Ethiopia was colonized by Germany.', D: 'Dr. Abiy Ahmed is the current Prime Minister of Ethiopia.' } },
             q7: { text: 'The primary aim of logic is to develop methods and principles used for:', choices: { A: 'Winning debates regardless of truth.', B: 'Understanding historical events.', C: 'Evaluating arguments and constructing good arguments.', D: 'Expressing personal beliefs clearly.' } },
             q8: { text: 'One of the major benefits of studying logic is:', choices: { A: 'Ensuring one always holds popular opinions.', B: 'Developing the skill to construct sound, fallacy-free arguments.', C: 'Learning how to avoid all disagreements.', D: 'Memorizing the arguments of famous philosophers.' } },
             q9: { text: 'Indicator words like "therefore," "thus," and "consequently" typically signal:', choices: { A: 'A premise.', B: 'A conclusion.', C: 'A non-argumentative passage.', D: 'An explanation.' } },
             q10: { text: 'Indicator words like "since," "because," and "for" typically signal:', choices: { A: 'A conclusion.', B: 'A conditional statement.', C: 'A premise.', D: 'A report.' } },
             q11: { text: 'If an argument contains no indicator words, how might the conclusion often be identified?', choices: { A: 'It is always the longest sentence.', B: 'It is usually the first statement in the passage.', C: 'It is the statement the arguer is trying to prove or establish as the main point.', D: 'It must be a universally accepted fact.' } },
             q12: { text: 'For a passage to contain an argument, it must fulfill two conditions: at least one statement must claim to present evidence/reasons, and:', choices: { A: 'All statements must be true.', B: 'There must be at least five sentences.', C: 'There must be a claim that this evidence supports or implies something (an inferential claim).', D: 'It must contain conclusion indicator words.' } },
             q13: { text: 'The claim that the premises support or imply the conclusion is known as the:', choices: { A: 'Factual claim.', B: 'Inferential claim.', C: 'Conditional claim.', D: 'Declarative claim.' } },
             q14: { text: 'An explicit inferential claim is typically asserted by:', choices: { A: 'The context of the passage alone.', B: 'The emotional tone of the language.', C: 'Premise or conclusion indicator words.', D: 'The truth-value of the statements.' } },
             q15: { text: 'An implicit inferential claim exists when:', choices: { A: 'There are indicator words present.', B: 'The passage is purely descriptive.', C: 'There is an inferential relationship between statements, but no indicator words.', D: 'The author explicitly states their intentions.' } },
             q16: { text: 'The mere presence of an indicator word like "since" guarantees:', choices: { A: 'The passage is a strong argument.', B: 'The passage is a valid argument.', C: 'The passage contains an argument.', D: 'Nothing; its function (temporal or logical) must be determined from context.' } },
             q17: { text: 'Passages such as warnings, pieces of advice, and statements of belief often lack:', choices: { A: 'Statements.', B: 'Truth-value.', C: 'An inferential claim.', D: 'Any clear subject matter.' } },
             q18: { text: 'An expository passage, which starts with a topic sentence and develops it, is considered an argument only if:', choices: { A: 'It contains the word "because".', B: 'The subsequent sentences aim to prove the topic sentence, not just elaborate on it.', C: 'The topic sentence is a question.', D: 'It is written by a famous author.' } },
             q19: { text: 'An illustration using examples is considered an argument (an argument from example) when:', choices: { A: 'It uses the indicator word "thus".', B: 'It merely shows what something means or how it is done.', C: 'The examples are intended to prove the truth of a more general claim.', D: 'The examples are very detailed.' } },
             q20: { text: 'An explanation differs from an argument in that its primary purpose is typically to:', choices: { A: 'Prove that a certain event occurred.', B: 'Shed light on why an accepted event occurred or why something is the case.', C: 'Persuade the audience to take action.', D: 'Present a sequence of historical facts.' } },
             q21: { text: 'In an explanation, the statement describing the event to be explained is the ________, and the statement(s) doing the explaining is/are the ________.', choices: { A: 'Premise; Conclusion', B: 'Conclusion; Premise', C: 'Explanandum; Explanans', D: 'Explanans; Explanandum' } },
             q22: { text: 'A single conditional statement ("If P, then Q") is not an argument because:', choices: { A: 'It always contains false statements.', B: 'It doesn\'t assert that either the antecedent (P) or the consequent (Q) is true.', C: 'It cannot contain indicator words.', D: 'It only expresses opinions.' } },
             q23: { text: 'In the conditional statement "If it rains, then the ground is wet," the antecedent is:', choices: { A: 'The ground is wet.', B: 'If it rains.', C: 'It rains.', D: 'Then the ground is wet.' } },
             q24: { text: 'Being a dog is a ________ condition for being an animal.', choices: { A: 'Necessary', B: 'Sufficient', C: 'Necessary and sufficient', D: 'Neither necessary nor sufficient' } },
             q25: { text: 'Being an animal is a ________ condition for being a dog.', choices: { A: 'Necessary', B: 'Sufficient', C: 'Necessary and sufficient', D: 'Neither necessary nor sufficient' } },
             q26: { text: 'A deductive argument is one where the premises are claimed to support the conclusion such that:', choices: { A: 'The conclusion is probably true if the premises are true.', B: 'It is impossible for the conclusion to be false if the premises are true.', C: 'The premises cause the conclusion to occur.', D: 'The argument uses statistical reasoning.' } },
             q27: { text: 'An inductive argument is one where the premises are claimed to support the conclusion such that:', choices: { A: 'It is impossible for the conclusion to be false if the premises are true.', B: 'The conclusion contains less information than the premises.', C: 'It is improbable for the conclusion to be false if the premises are true.', D: 'The argument form is always a syllogism.' } },
             q28: { text: 'The distinction between deductive and inductive arguments lies primarily in:', choices: { A: 'The number of premises.', B: 'The truth value of the conclusion.', C: 'The strength of the argument\'s inferential claim.', D: 'Whether the argument contains indicator words.' } },
             q29: { text: 'Which factor is NOT listed as influencing the decision about whether an argument is deductive or inductive?', choices: { A: 'The occurrence of special indicator words (e.g., "necessarily", "probably").', B: 'The actual strength of the inferential link.', C: 'The character or form of argumentation used.', D: 'The emotional appeal of the conclusion.' } },
             q30: { text: 'Arguments based on mathematics (excluding statistics) are generally interpreted as:', choices: { A: 'Inductive.', B: 'Deductive.', C: 'Explanations.', D: 'Conditional statements.' } },
             q31: { text: 'An argument where the conclusion depends merely on the definition of a word used in the premise (e.g., "Kebede is a bachelor, therefore Kebede is unmarried") is typically:', choices: { A: 'Inductive.', B: 'An argument from analogy.', C: 'Deductive.', D: 'A causal inference.' } },
             q32: { text: 'A syllogism having a conditional statement ("If...then...") for one or both of its premises is known as a:', choices: { A: 'Categorical syllogism.', B: 'Disjunctive syllogism.', C: 'Hypothetical syllogism.', D: 'Inductive generalization.' } },
             q33: { text: 'A syllogism having a disjunctive statement ("Either...or...") is known as a:', choices: { A: 'Categorical syllogism.', B: 'Disjunctive syllogism.', C: 'Hypothetical syllogism.', D: 'Prediction.' } },
             q34: { text: 'An argument that proceeds from the knowledge of a selected sample to a claim about the whole group is a(n):', choices: { A: 'Argument from definition.', B: 'Inductive generalization.', C: 'Deductive syllogism.', D: 'Argument based on mathematics.' } },
             q35: { text: 'An argument that concludes something about the future based on knowledge of the present or past is a(n):', choices: { A: 'Argument from definition.', B: 'Disjunctive syllogism.', C: 'Prediction.', D: 'Argument based on mathematics.' } },
             q36: { text: 'An argument that depends on the existence of a similarity between two things or states of affairs is a(n):', choices: { A: 'Argument from analogy.', B: 'Categorical syllogism.', C: 'Argument from definition.', D: 'Causal inference.' } },
             q37: { text: 'An argument where the conclusion rests on a statement made by a presumed authority or witness is a(n):', choices: { A: 'Argument based on mathematics.', B: 'Argument from authority.', C: 'Argument from definition.', D: 'Hypothetical syllogism.' } },
             q38: { text: 'The traditional view that induction proceeds from particular to general and deduction from general to particular is:', choices: { A: 'Always accurate and the best way to distinguish them.', B: 'Largely incorrect, as examples exist that contradict this pattern for both types.', C: 'Accurate only for arguments in mathematics.', D: 'The only definition provided in the text.' } },
             q39: { text: 'A valid deductive argument is one where:', choices: { A: 'All the premises are true.', B: 'The conclusion is true.', C: 'If the premises are assumed true, it is impossible for the conclusion to be false.', D: 'The conclusion is probably true given the premises.' } },
             q40: { text: 'An invalid deductive argument is one where:', choices: { A: 'All the premises are false.', B: 'The conclusion is false.', C: 'It is possible for the conclusion to be false even if the premises are assumed true.', D: 'The argument contains indicator words.' } },
             q41: { text: 'Which combination of truth values is impossible for a valid deductive argument?', choices: { A: 'True premises, True conclusion.', B: 'False premises, True conclusion.', C: 'False premises, False conclusion.', D: 'True premises, False conclusion.' } },
             q42: { text: 'Validity is determined primarily by:', choices: { A: 'The actual truth or falsity of the premises.', B: 'The actual truth or falsity of the conclusion.', C: 'The inferential relationship or connection between premises and conclusion.', D: 'The number of statements in the argument.' } },
             q43: { text: 'A sound deductive argument is defined as an argument that is:', choices: { A: 'Valid and has a true conclusion.', B: 'Invalid but has true premises.', C: 'Valid and has all true premises.', D: 'Persuasive to the audience.' } },
             q44: { text: 'An unsound deductive argument is one that is:', choices: { A: 'Valid but has false premises.', B: 'Invalid.', C: 'Invalid with false premises.', D: 'Any of the above (Invalid OR Valid with one or more false premise OR both).' } },
             q45: { text: 'A strong inductive argument is one where:', choices: { A: 'The conclusion follows with strict necessity from the premises.', B: 'If the premises are assumed true, the conclusion is improbable.', C: 'If the premises are assumed true, the conclusion is probable.', D: 'All the premises are known to be true.' } },
             q46: { text: 'A weak inductive argument is one where:', choices: { A: 'The conclusion is definitely false.', B: 'If the premises are assumed true, the conclusion does not follow probably.', C: 'The premises are all false.', D: 'It contains fewer than three premises.' } },
             q47: { text: 'Unlike validity/invalidity, the strength/weakness of inductive arguments:', choices: { A: 'Is absolute (no degrees).', B: 'Admits of degrees.', C: 'Depends only on the conclusion\'s truth value.', D: 'Is irrelevant to argument evaluation.' } },
             q48: { text: 'Which combination of truth values guarantees that an inductive argument is weak?', choices: { A: 'True premises, True conclusion.', B: 'False premises, True conclusion.', C: 'False premises, False conclusion.', D: 'True premises, False conclusion.' } },
             q49: { text: 'A cogent inductive argument is defined as an argument that is:', choices: { A: 'Strong and has a probably true conclusion.', B: 'Weak but has true premises.', C: 'Strong and has all true premises (and considers all relevant evidence).', D: 'Valid and has true premises.' } },
             q50: { text: 'An uncogent inductive argument is one that is:', choices: { A: 'Strong but has false premises.', B: 'Weak.', C: 'Weak with false premises.', D: 'Any of the above (Weak OR Strong with one or more false premise OR both).' } }
        };


        // Correct answers mapped to letters (Matches the HTML form answers)
        const correctAnswersMap = {
             q1: 'B', q2: 'B', q3: 'C', q4: 'A', q5: 'C',
             q6: 'B', q7: 'C', q8: 'B', q9: 'B', q10: 'C',
             q11: 'C', q12: 'C', q13: 'B', q14: 'C', q15: 'C',
             q16: 'D', q17: 'C', q18: 'B', q19: 'C', q20: 'B',
             q21: 'C', q22: 'B', q23: 'C', q24: 'B', q25: 'A',
             q26: 'B', q27: 'C', q28: 'C', q29: 'D', q30: 'B',
             q31: 'C', q32: 'C', q33: 'B', q34: 'B', q35: 'C',
             q36: 'A', q37: 'B', q38: 'B', q39: 'C', q40: 'C',
             q41: 'D', q42: 'C', q43: 'C', q44: 'D', q45: 'C',
             q46: 'B', q47: 'B', q48: 'D', q49: 'C', q50: 'D'
        };

        function checkLogin() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('login-password').value.trim();
            const errorMessage = document.getElementById('login-error');
            const loginSection = document.getElementById('login-section');
            const quizForm = document.getElementById('quiz-form');

            const isValid = validCredentials.some(cred =>
                cred.username === username && cred.password === password
            );

            if (isValid) {
                errorMessage.classList.add('hidden');
                loginSection.classList.add('hidden');
                quizForm.classList.remove('hidden');
            } else {
                errorMessage.classList.remove('hidden');
            }
        }

        function showReview() {
            const form = document.getElementById('mcie-quiz');
            formData = new FormData(form);
            const data = Object.fromEntries(formData);

             // Check if all questions are answered
             let allAnswered = true;
             for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 if (!data[`q${i}`]) {
                     allAnswered = false;
                     break;
                 }
             }

             if (!data.name || !data.id_number || !data.section || !data.email || !data.phone || !allAnswered) {
                 alert('Please fill in all personal information and answer all questions before submitting.');
                 return; // Stop the function if validation fails
             }

            // Store quiz data temporarily
            quizData = {
                name: data.name,
                id_number: data.id_number,
                section: data.section,
                email: data.email,
                phone: data.phone,
                answers: {},
                questions: allQuestionsData, // Use the predefined structure
                chapter: CURRENT_QUIZ_CHAPTER, // Added chapter to quizData
                courseCode: COURSE_CODE // Added course code to quizData
            };

            // Construct the formatted chapter string for display
             const formattedCourseChapter = `${quizData.courseCode} Chapter ${quizData.chapter}`;


            // Populate answers dynamically
            let reviewHTML = `
                <p><strong>Name:</strong> ${data.name}</p>
                <p><strong>ID Number:</strong> ${data.id_number}</p>
                <p><strong>Section:</strong> ${data.section}</p>
                <p><strong>Email:</strong> ${data.email}</p>
                <p><strong>Phone Number:</strong> ${data.phone}</p>
                 <p><strong>Chapter:</strong> ${quizData.chapter}</p>
                 <p><strong>Course & Chapter:</strong> ${formattedCourseChapter}</p> <!-- Added formatted chapter to review display -->
                <hr>
                <h3>Your Answers:</h3>
            `;

            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                const qKey = `q${i}`;
                const userAnswer = data[qKey];
                quizData.answers[qKey] = userAnswer; // Store answer
                const questionInfo = allQuestionsData[qKey];
                const answerText = questionInfo.choices[userAnswer] || 'Not Answered';
                reviewHTML += `<p><strong>Question ${i}:</strong> ${questionInfo.text}<br>Your answer: ${userAnswer}) ${answerText}</p>`;
            }

            // Display review content
            const reviewContent = document.getElementById('review-content');
            reviewContent.innerHTML = reviewHTML;

            // Show review section
            document.getElementById('quiz-form').classList.add('hidden');
            document.getElementById('review-section').classList.remove('hidden');
        }

        function editForm() {
            document.getElementById('review-section').classList.add('hidden');
            document.getElementById('quiz-form').classList.remove('hidden');
        }

        function downloadResponse() {
            if (!quizData) return;

            const doc = new jsPDF();
            let y = 10;
            const pageHeight = doc.internal.pageSize.height;
            const pageWidth = doc.internal.pageSize.width;
            const margin = 10;
            const effectiveWidth = pageWidth - margin * 2;

             const formattedCourseChapter = `${quizData.courseCode} Chapter ${quizData.chapter}`;


            doc.setFontSize(16);
            doc.text(`${formattedCourseChapter} Quiz Response`, pageWidth / 2, y, { align: 'center' }); // Updated Title
            y += 10;

            doc.setFontSize(12);
            doc.text(`Name: ${quizData.name}`, margin, y); y += 7;
            doc.text(`ID: ${quizData.id_number}`, margin, y); y += 7;
            doc.text(`Section: ${quizData.section}`, margin, y); y += 7;
            doc.text(`Email: ${quizData.email}`, margin, y); y += 7;
            doc.text(`Phone: ${quizData.phone}`, margin, y); y += 7;
            doc.text(`Chapter: ${quizData.chapter}`, margin, y); y += 7;
            doc.text(`Course & Chapter: ${formattedCourseChapter}`, margin, y); y += 10; // Added formatted chapter to PDF


            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const question = quizData.questions[qKey];
                 const userAnswer = quizData.answers[qKey];
                 const answerText = question.choices[userAnswer] || 'Not Answered';
                 const questionText = question.text;

                 // Estimate space needed for the question + answer
                 const questionLines = doc.splitTextToSize(`Question ${i}: ${questionText}`, effectiveWidth);
                 const answerLines = doc.splitTextToSize(`Your answer: ${userAnswer}) ${answerText}`, effectiveWidth);
                 const spaceNeeded = (questionLines.length * 5) + 2 + (answerLines.length * 5) + 5; // Estimate lines * line height + spacing

                 if (y + spaceNeeded > pageHeight - margin) {
                    doc.addPage();
                    y = margin;
                 }

                doc.setFont('helvetica', 'bold');
                doc.text(questionLines, margin, y);
                y += (questionLines.length * 5) + 2;
                doc.setFont('helvetica', 'normal');

                if (y > pageHeight - margin) { doc.addPage(); y = margin; }

                doc.text(answerLines, margin, y);
                y += (answerLines.length * 5) + 5;

            }

            // Updated filename
            doc.save(`${formattedCourseChapter.replace(/ /g, '_')}_response_${quizData.id_number}.pdf`);
        }

        // --- MODIFIED: confirmSubmission Function ---
        async function confirmSubmission() {
            if (confirm('Are you sure you want to submit your answers?')) {
                if (!quizData || !formData) {
                     console.error("Quiz data or form data is missing.");
                     alert("Error: Cannot submit. Please try filling the form again.");
                     editForm(); // Go back to edit
                     return;
                }

                const data = Object.fromEntries(formData); // Use the stored formData

                // Calculate score
                let score = 0;
                for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                    const qKey = `q${i}`;
                    if (data[qKey] === correctAnswersMap[qKey]) {
                        score++;
                    }
                }

                // Update quizData with score (Optional but good practice)
                quizData.score = score;

                // *** CONSTRUCT THE FORMATTED CHAPTER STRING ***
                const formattedCourseChapter = `${COURSE_CODE} Chapter ${CURRENT_QUIZ_CHAPTER}`;


                // Prepare data for YOUR backend
                const submissionData = {
                    name: data.name,
                    id_number: data.id_number,
                    section: data.section,
                    email: data.email,
                    phone: data.phone,
                    score: score,
                    totalQuestions: TOTAL_QUESTIONS,
                    quizChapter: CURRENT_QUIZ_CHAPTER, // Keep the integer
                    // quizTitle: "Basic Concepts of Logic Quiz - Chapter 2", // You can keep or remove this
                    // submittedAt: new Date().toISOString(),
                    // answers: quizData.answers // You can add this if your backend table had a jsonb column for answers

                    // *** ADD THE NEW FIELD WITH THE FORMATTED STRING ***
                    course_chapter_formatted: formattedCourseChapter,
                };

                console.log("Submitting quiz data:", submissionData);

                try {
                    // Show "Submitting..." message or spinner here if desired

                    const response = await fetch('/submit-quiz', { // Point to your backend endpoint
                        method: 'POST',
                        body: JSON.stringify(submissionData), // Send the data as JSON
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json' // Important Header!
                        }
                    });

                    if (response.ok) {
                        const result = await response.json();
                        console.log('Submission successful:', result);
                        alert("Quiz submitted successfully!"); // Provide feedback to user

                        // Show submission copy
                        const submissionContent = document.getElementById('submission-content');
                         let submissionHTML = `
                            <p><strong>Name:</strong> ${quizData.name}</p>
                            <p><strong>ID Number:</strong> ${quizData.id_number}</p>
                            <p><strong>Section:</strong> ${quizData.section}</p>
                            <p><strong>Email:</strong> ${quizData.email}</p>
                            <p><strong>Phone Number:</strong> ${quizData.phone}</p>
                            <p><strong>Chapter:</strong> ${quizData.chapter}</p>
                             <p><strong>Course & Chapter:</strong> ${formattedCourseChapter}</p> <!-- Added formatted chapter to submission copy -->
                            <hr>
                            <h3>Submitted Answers:</h3>
                        `;
                         for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                             const qKey = `q${i}`;
                             const questionInfo = quizData.questions[qKey];
                             const userAnswer = quizData.answers[qKey];
                             const answerText = questionInfo.choices[userAnswer] || 'Not Answered';
                             submissionHTML += `<p><strong>Question ${i}:</strong> ${questionInfo.text}<br>Your answer: ${userAnswer}) ${answerText}</p>`;
                         }
                        submissionContent.innerHTML = submissionHTML;

                        document.getElementById('review-section').classList.add('hidden');
                        document.getElementById('submission-copy').classList.remove('hidden');


                    } else {
                        let errorMsg = `Submission failed with status: ${response.status}`;
                        try {
                            const errorData = await response.json();
                            errorMsg = errorData.error || errorData.message || errorMsg;
                        } catch(e) { /* Ignore if response isn't JSON */ }

                        console.error('Backend submission error:', errorMsg);
                        document.getElementById('error-message').innerHTML = `<p>Submission failed: ${errorMsg}. Please try again.</p>`;
                        document.getElementById('error-message').classList.remove('hidden');
                        document.getElementById('review-section').classList.add('hidden');
                    }
                } catch (error) {
                    console.error('Network/Fetch error:', error);
                    document.getElementById('error-message').innerHTML = `<p>An network error occurred during submission. Please check your connection and try again.</p>`;
                    document.getElementById('error-message').classList.remove('hidden');
                    document.getElementById('review-section').classList.add('hidden');
                }
            }
        }


        function proceedToPassword() {
            document.getElementById('submission-copy').classList.add('hidden');
            document.getElementById('password-section').classList.remove('hidden');
        }

        function checkPassword() {
            const passwordInput = document.getElementById('password').value;
            const correctPassword = 'password'; // Keep the simple password
            const errorMessage = document.getElementById('password-error');
            const passwordSection = document.getElementById('password-section');
            const results = document.getElementById('results');

            if (passwordInput === correctPassword) {
                errorMessage.classList.add('hidden');
                passwordSection.classList.add('hidden');
                results.classList.remove('hidden');
                displayResults();
            } else {
                errorMessage.classList.remove('hidden');
            }
        }

        function displayResults() {
            if (!quizData) {
                document.getElementById('results').innerHTML = '<p>Error: No quiz data found. Please complete the quiz first.</p>';
                return;
            }

             // Combine correct answer letter with full text for display
             const displayCorrectAnswers = {};
             for(let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const correctLetter = correctAnswersMap[qKey];
                 const correctText = allQuestionsData[qKey].choices[correctLetter];
                 displayCorrectAnswers[qKey] = `${correctLetter}) ${correctText}`; // Changed format slightly
             }

            const formattedCourseChapter = `${quizData.courseCode} Chapter ${quizData.chapter}`;

            // Added formatted chapter to results display
            document.getElementById('student-info').innerHTML = `<strong>Name:</strong> ${quizData.name}<br><strong>ID:</strong> ${quizData.id_number}<br><strong>Section:</strong> ${quizData.section}<br><strong>Email:</strong> ${quizData.email}<br><strong>Phone:</strong> ${quizData.phone}<br><strong>Chapter:</strong> ${quizData.chapter}<br><strong>Course & Chapter:</strong> ${formattedCourseChapter}`;


            const answersDiv = document.getElementById('answers');
            let answersHTML = '<h3>Detailed Results:</h3>';

            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const question = quizData.questions[qKey];
                 const userAnswer = quizData.answers[qKey];
                 const userAnswerText = question.choices[userAnswer] || 'Not Answered';
                 const isCorrect = userAnswer === correctAnswersMap[qKey];

                 answersHTML += `
                    <div class="question-result">
                        <p><strong>Question ${i}:</strong> ${question.text}</p>
                        <div class="choices" style="font-size:0.9em; margin-left: 15px;">
                            <p>A) ${question.choices.A}</p>
                            <p>B) ${question.choices.B}</p>
                            <p>C) ${question.choices.C}</p>
                            <p>D) ${question.choices.D}</p>
                        </div>
                        <p>Your answer: ${userAnswer}) ${userAnswerText} ${isCorrect ? '<span style="color:green; font-weight:bold;">(Correct)</span>' : '<span style="color:red; font-weight:bold;">(Incorrect)</span>'}</p>
                        ${!isCorrect ? `<p style="color:blue;">Correct answer: ${displayCorrectAnswers[qKey]}</p>` : ''}
                    </div>
                `;
            }
            answersDiv.innerHTML = answersHTML;


            document.getElementById('score').textContent = `Final Score: ${quizData.score} / ${TOTAL_QUESTIONS}`;
        }

        function downloadPDF() {
            if (!quizData) return;

            const doc = new jsPDF();
            let y = 10;
            const pageHeight = doc.internal.pageSize.height;
            const pageWidth = doc.internal.pageSize.width;
            const margin = 10;
            const effectiveWidth = pageWidth - margin * 2;

             // Combine correct answer letter with full text for display
             const displayCorrectAnswers = {};
             for(let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const correctLetter = correctAnswersMap[qKey];
                 const correctText = allQuestionsData[qKey].choices[correctLetter];
                 displayCorrectAnswers[qKey] = `${correctLetter}) ${correctText}`;
             }

            const formattedCourseChapter = `${quizData.courseCode} Chapter ${quizData.chapter}`;

            doc.setFontSize(16);
            doc.text(`${formattedCourseChapter} Quiz Results`, pageWidth / 2, y, { align: 'center' });
            y += 10;

            doc.setFontSize(12);
            doc.text(`Name: ${quizData.name}`, margin, y); y += 7;
            doc.text(`ID: ${quizData.id_number}`, margin, y); y += 7;
            doc.text(`Section: ${quizData.section}`, margin, y); y += 7;
            doc.text(`Email: ${quizData.email}`, margin, y); y += 7;
            doc.text(`Phone: ${quizData.phone}`, margin, y); y += 7;
             // Added formatted chapter to PDF
            doc.text(`Course & Chapter: ${formattedCourseChapter}`, margin, y); y += 10;


            doc.setFont('helvetica', 'bold');
            doc.text(`Final Score: ${quizData.score} / ${TOTAL_QUESTIONS}`, pageWidth / 2, y, { align: 'center' });
            y += 10;
            doc.setFont('helvetica', 'normal');


            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const question = quizData.questions[qKey];
                 const userAnswer = quizData.answers[qKey];
                 const userAnswerText = question.choices[userAnswer] || 'Not Answered';
                 const isCorrect = userAnswer === correctAnswersMap[qKey];
                 const questionText = question.text;
                 const correctAnswerFull = displayCorrectAnswers[qKey];

                 // Estimate space needed
                 const qLines = doc.splitTextToSize(`Question ${i}: ${questionText}`, effectiveWidth);
                 const choicesLines = 4 * 5; // Estimate for 4 choices at 5 units per line height
                 const yourAnsLines = doc.splitTextToSize(`Your answer: ${userAnswer}) ${userAnswerText} ${isCorrect ? '(Correct)' : '(Incorrect)'}`, effectiveWidth);
                 const correctAnsLinesHeight = isCorrect ? 0 : doc.splitTextToSize(`Correct answer: ${correctAnswerFull}`, effectiveWidth).length * 5; // Height needed for correct answer if wrong
                 const spaceNeeded = (qLines.length * 5) + 2 + choicesLines + 7 + (yourAnsLines.length * 5) + 7 + correctAnsLinesHeight + 5;


                 if (y + spaceNeeded > pageHeight - margin) {
                    doc.addPage();
                    y = margin;
                }

                doc.setFont('helvetica', 'bold');
                doc.text(qLines, margin, y);
                y += (qLines.length * 5) + 2;
                doc.setFont('helvetica', 'normal');

                 const remainingSpaceAfterQuestion = pageHeight - margin - y;
                 const answersSectionSpace = choicesLines + 7 + (yourAnsLines.length * 5) + 7 + correctAnsLinesHeight + 5;

                 if (answersSectionSpace > remainingSpaceAfterQuestion) {
                     doc.addPage();
                     y = margin;
                 }


                doc.setFontSize(10);
                doc.text(`  A) ${question.choices.A}`, margin + 5, y); y += 5;
                doc.text(`  B) ${question.choices.B}`, margin + 5, y); y += 5;
                doc.text(`  C) ${question.choices.C}`, margin + 5, y); y += 5;
                doc.text(`  D) ${question.choices.D}`, margin + 5, y); y += 7;
                doc.setFontSize(12);


                doc.text(`Your answer: ${userAnswer}) ${userAnswerText} ${isCorrect ? '(Correct)' : '(Incorrect)'}`, margin, y); y += 7;

                if (!isCorrect) {
                    doc.setTextColor(0, 0, 255);
                    doc.text(`Correct answer: ${correctAnswerFull}`, margin, y); y += 7;
                    doc.setTextColor(0, 0, 0);
                }
                y += 5;

            }

            if (y > pageHeight - margin) { doc.addPage(); y = margin; }
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(14);
            doc.text(`Final Score: ${quizData.score} / ${TOTAL_QUESTIONS}`, pageWidth / 2, y, { align: 'center' });

            // Updated filename to include formatted chapter
            doc.save(`${formattedCourseChapter.replace(/ /g, '_')}_results_${quizData.id_number}.pdf`);
        }
    </script>

</body>
</html>
